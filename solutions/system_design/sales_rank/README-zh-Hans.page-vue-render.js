
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"fixed":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"brand",fn:function(){return [_c('a',{staticClass:"navbar-brand",attrs:{"href":"https://mazx4960.github.io/system-design-primer//index.html","title":"Home"}},[_v("System Design Primer")])]},proxy:true},{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_v(" "),_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Solutions")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/mint/README.html"}},[_v("mint")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/pastebin/README.html"}},[_v("pastebin")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/query_cache/README.html"}},[_v("query_cache")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/sales_rank/README.html"}},[_v("sales_rank")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/scaling_aws/README.html"}},[_v("scaling_aws")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/social_graph/README.html"}},[_v("social_graph")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/twitter/README.html"}},[_v("twitter")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/web_crawler/README.html"}},[_v("web_crawler")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"font-weight-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Topics")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Preface\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Motivation.html"}},[_v("Motivation")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Ankiflashcards.html"}},[_v("Anki flashcards")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Indexof-system-design-topics.html"}},[_v("Index")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Studyguide.html"}},[_v("Study Guide")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Interview Questions\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Howto-approach-a-system-design-interview-question.html"}},[_v("How to approach a system design interview question")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Object-orienteddesign-interview-questions-with-solutions.html"}},[_v("OOP interview questions")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-interview-questions-with-solutions.html"}},[_v("System design interview questions")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-topics-start-here.html"}},[_v("System design topics")]),_v(" "),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Performancevs-scalability.html"}},[_v("Performance vs scalability")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Latencyvs-throughput.html"}},[_v("Latency vs throughput")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilityvs-consistency.html"}},[_v("Availability vs consistency")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Consistencypatterns.html"}},[_v("Consistency patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilitypatterns.html"}},[_v("Availability patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Domainname-system.html"}},[_v("Domain name system")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contentdelivery-network.html"}},[_v("Content delivery network")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Loadbalancer.html"}},[_v("Load balancer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Reverseproxy-(web-server).html"}},[_v("Reverse proxy (web server)")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Applicationlayer.html"}},[_v("Application layer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Database.html"}},[_v("Database")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Cache.html"}},[_v("Cache")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Asynchronism.html"}},[_v("Asynchronism")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Communication.html"}},[_v("Communication")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Security.html"}},[_v("Security")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Misc\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Appendix.html"}},[_v("Appendix")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Underdevelopment.html"}},[_v("Under development")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Credits.html"}},[_v("Credits")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contactinfo.html"}},[_v("Contact info")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contributing.html"}},[_v("Contributing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/License.html"}},[_v("License")])])])])])])],1)],1)]),_v(" "),_m(0),_v(" "),_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"})])],1),_v(" "),_m(1)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('div',{staticClass:"fixed-header-padding",attrs:{"id":"content-wrapper"}},[_c('h1',{attrs:{"id":"amazon"}},[_c('span',{staticClass:"anchor",attrs:{"id":"amazon"}}),_v("为 Amazon 设计分类售卖排行"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#amazon","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("注意：这个文档中的链接会直接指向"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95"}},[_v("系统设计主题索引")]),_v("中的有关部分，以避免重复的内容。你可以参考链接的相关内容，来了解其总的要点、方案的权衡取舍以及可选的替代方案。")])]),_v(" "),_c('h2',{attrs:{"id":""}},[_v("第一步：简述用例与约束条件")]),_v(" "),_c('blockquote',[_c('p',[_v("搜集需求与问题的范围。\n提出问题来明确用例与约束条件。\n讨论假设。")])]),_v(" "),_c('p',[_v("我们将在没有面试官明确说明问题的情况下，自己定义一些用例以及限制条件。")]),_v(" "),_c('h3',{attrs:{"id":"-2"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-2"}}),_v("用例"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-2","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-3"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-3"}}),_v("我们将把问题限定在仅处理以下用例的范围中"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-3","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("服务")]),_v("根据分类计算过去一周中最受欢迎的商品")]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v("通过分类浏览过去一周中最受欢迎的商品")]),_v(" "),_c('li',[_c('strong',[_v("服务")]),_v("有着高可用性")])]),_v(" "),_c('h4',{attrs:{"id":"-4"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-4"}}),_v("不在用例范围内的有"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-4","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("一般的电商网站\n"),_c('ul',[_c('li',[_v("只为售卖排行榜设计组件")])])])]),_v(" "),_c('h3',{attrs:{"id":"-5"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-5"}}),_v("限制条件与假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-5","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-6"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-6"}}),_v("提出假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-6","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("网络流量不是均匀分布的")]),_v(" "),_c('li',[_v("一个商品可能存在于多个分类中")]),_v(" "),_c('li',[_v("商品不能够更改分类")]),_v(" "),_c('li',[_v("不会存在如 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("foo/bar/baz")]),_v(" 之类的子分类")]),_v(" "),_c('li',[_v("每小时更新一次结果\n"),_c('ul',[_c('li',[_v("受欢迎的商品越多，就需要更频繁地更新")])])]),_v(" "),_c('li',[_v("1000 万个商品")]),_v(" "),_c('li',[_v("1000 个分类")]),_v(" "),_c('li',[_v("每个月 10 亿次交易")]),_v(" "),_c('li',[_v("每个月 1000 亿次读取请求")]),_v(" "),_c('li',[_v("100:1 的读写比例")])]),_v(" "),_c('h4',{attrs:{"id":"-7"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-7"}}),_v("计算用量"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-7","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("如果你需要进行粗略的用量计算，请向你的面试官说明。")])]),_v(" "),_c('ul',[_c('li',[_v("每笔交易的用量：\n"),_c('ul',[_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("created_at")]),_v(" - 5 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("product_id")]),_v(" - 8 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("category_id")]),_v(" - 4 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("seller_id")]),_v(" - 8 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("buyer_id")]),_v(" - 8 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("quantity")]),_v(" - 4 字节")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("total_price")]),_v(" - 5 字节")]),_v(" "),_c('li',[_v("总计：大约 40 字节")])])]),_v(" "),_c('li',[_v("每个月的交易内容会产生 40 GB 的记录\n"),_c('ul',[_c('li',[_v("每次交易 40 字节 * 每个月 10 亿次交易")]),_v(" "),_c('li',[_v("3年内产生了 1.44 TB 的新交易内容记录")]),_v(" "),_c('li',[_v("假定大多数的交易都是新交易而不是更改以前进行完的交易")])])]),_v(" "),_c('li',[_v("平均每秒 400 次交易次数")]),_v(" "),_c('li',[_v("平均每秒 40,000 次读取请求")])]),_v(" "),_c('p',[_v("便利换算指南：")]),_v(" "),_c('ul',[_c('li',[_v("每个月有 250 万秒")]),_v(" "),_c('li',[_v("每秒一个请求 = 每个月 250 万次请求")]),_v(" "),_c('li',[_v("每秒 40 个请求 = 每个月 1 亿次请求")]),_v(" "),_c('li',[_v("每秒 400 个请求 = 每个月 10 亿次请求")])]),_v(" "),_c('h2',{attrs:{"id":"-8"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-8"}}),_v("第二步：概要设计"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-8","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("列出所有重要组件以规划概要设计。")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/vwMa1Qu.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/vwMa1Qu.png","alt":""}})])]),_v(" "),_c('h2',{attrs:{"id":"-9"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-9"}}),_v("第三步：设计核心组件"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-9","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("深入每个核心组件的细节。")])]),_v(" "),_c('h3',{attrs:{"id":"-10"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-10"}}),_v("用例：服务需要根据分类计算上周最受欢迎的商品"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-10","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("我们可以在现成的"),_c('strong',[_v("对象存储")]),_v("系统（例如 Amazon S3 服务）中存储 "),_c('strong',[_v("售卖 API")]),_v(" 服务产生的日志文本， 因此不需要我们自己搭建分布式文件系统了。")]),_v(" "),_c('p',[_c('strong',[_v("向你的面试官告知你准备写多少代码")]),_v("。")]),_v(" "),_c('p',[_v("假设下面是一个用 tab 分割的简易的日志记录：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("timestamp   product_id  category_id    qty     total_price   seller_id    buyer_id\n")]),_c('span',[_v("t1          product1    category1      2       20.00         1            1\n")]),_c('span',[_v("t2          product1    category2      2       20.00         2            2\n")]),_c('span',[_v("t2          product1    category2      1       10.00         2            3\n")]),_c('span',[_v("t3          product2    category1      3        7.00         3            4\n")]),_c('span',[_v("t4          product3    category2      7        2.00         4            5\n")]),_c('span',[_v("t5          product4    category1      1        5.00         5            6\n")]),_c('span',[_v("...\n")])])]),_c('p',[_c('strong',[_v("售卖排行服务")]),_v(" 需要用到 "),_c('strong',[_v("MapReduce")]),_v("，并使用 "),_c('strong',[_v("售卖 API")]),_v(" 服务进行日志记录，同时将结果写入 "),_c('strong',[_v("SQL 数据库")]),_v("中的总表 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("sales_rank")]),_v(" 中。我们也可以讨论一下"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%BF%98%E6%98%AF-nosql"}},[_v("究竟是用 SQL 还是用 NoSQL")]),_v("。")]),_v(" "),_c('p',[_v("我们需要通过以下步骤使用 "),_c('strong',[_v("MapReduce")]),_v("：")]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("第 1 步")]),_v(" - 将数据转换为 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("(category, product_id), sum(quantity)")]),_v(" 的形式")]),_v(" "),_c('li',[_c('strong',[_v("第 2 步")]),_v(" - 执行分布式排序")])]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("SalesRanker")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("MRJob")]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("within_past_week")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, timestamp")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"如果时间戳属于过去的一周则返回 True，")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        否则返回 False。\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("mapper")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, _ line")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"解析日志的每一行，提取并转换相关行，")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        将键值对设定为如下形式：")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product1), 2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, product1), 2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, product1), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product2), 3")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, product3), 7")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product4), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        timestamp, product_id, category_id, quantity, total_price, seller_id, \\\n")]),_c('span',[_v("            buyer_id = line.split("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'\\t'")]),_v(")\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" self.within_past_week(timestamp):\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" (category_id, product_id), quantity\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("reducer")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, key, value")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"将每个 key 的值加起来。")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product1), 2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, product1), 3")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product2), 3")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, product3), 7")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, product4), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" key, "),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("sum")]),_v("(values)\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("mapper_sort")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, key, value")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"构造 key 以确保正确的排序。")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        将键值对转换成如下形式：")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 2), product1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, 3), product1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 3), product2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, 7), product3")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 1), product4")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        MapReduce 的随机排序步骤会将键")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        值的排序打乱，变成下面这样：")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 1), product4")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 2), product1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category1, 3), product2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, 3), product1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (category2, 7), product3")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        category_id, product_id = key\n")]),_c('span',[_v("        quantity = value\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" (category_id, quantity), product_id\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("reducer_identity")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, key, value")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" key, value\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("steps")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\" 此处为 map reduce 步骤\"\"\"")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" [\n")]),_c('span',[_v("            self.mr(mapper=self.mapper,\n")]),_c('span',[_v("                    reducer=self.reducer),\n")]),_c('span',[_v("            self.mr(mapper=self.mapper_sort,\n")]),_c('span',[_v("                    reducer=self.reducer_identity),\n")]),_c('span',[_v("        ]\n")])])]),_c('p',[_v("得到的结果将会是如下的排序列，我们将其插入 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("sales_rank")]),_v(" 表中：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("(category1, 1), product4\n")]),_c('span',[_v("(category1, 2), product1\n")]),_c('span',[_v("(category1, 3), product2\n")]),_c('span',[_v("(category2, 3), product1\n")]),_c('span',[_v("(category2, 7), product3\n")])])]),_c('p',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("sales_rank")]),_v(" 表的数据结构如下：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("id int NOT NULL AUTO_INCREMENT\n")]),_c('span',[_v("category_id int NOT NULL\n")]),_c('span',[_v("total_sold int NOT NULL\n")]),_c('span',[_v("product_id int NOT NULL\n")]),_c('span',[_v("PRIMARY KEY(id)\n")]),_c('span',[_v("FOREIGN KEY(category_id) REFERENCES Categories(id)\n")]),_c('span',[_v("FOREIGN KEY(product_id) REFERENCES Products(id)\n")])])]),_c('p',[_v("我们会以 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("id")]),_v("、"),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("category_id")]),_v(" 与 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("product_id")]),_v(" 创建一个 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#use-good-indices"}},[_v("索引")]),_v("以加快查询速度（只需要使用读取日志的时间，不再需要每次都扫描整个数据表）并让数据常驻内存。从内存读取 1 MB 连续数据大约要花 250 微秒，而从 SSD 读取同样大小的数据要花费 4 倍的时间，从机械硬盘读取需要花费 80 倍以上的时间。"),_c('sup',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#每个程序员都应该知道的延迟数"}},[_v("1")])])]),_v(" "),_c('h3',{attrs:{"id":"-11"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-11"}}),_v("用例：用户需要根据分类浏览上周中最受欢迎的商品"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-11","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("客户端")]),_v("向运行"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"}},[_v("反向代理")]),_v("的 "),_c('strong',[_v("Web 服务器")]),_v("发送一个请求")]),_v(" "),_c('li',[_v("这个 "),_c('strong',[_v("Web 服务器")]),_v("将请求转发给"),_c('strong',[_v("查询 API")]),_v(" 服务")]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("查询 API")]),_v(" 服务将从 "),_c('strong',[_v("SQL 数据库")]),_v("的 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("sales_rank")]),_v(" 表中读取数据")])]),_v(" "),_c('p',[_v("我们可以调用一个公共的 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%A1%A8%E8%BF%B0%E6%80%A7%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BBrest"}},[_v("REST API")]),_v("：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("$ curl https://amazon.com/api/v1/popular?category_id=1234\n")])])]),_c('p',[_v("返回：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("{\n")]),_c('span',[_v("    \"id\": \"100\",\n")]),_c('span',[_v("    \"category_id\": \"1234\",\n")]),_c('span',[_v("    \"total_sold\": \"100000\",\n")]),_c('span',[_v("    \"product_id\": \"50\",\n")]),_c('span',[_v("},\n")]),_c('span',[_v("{\n")]),_c('span',[_v("    \"id\": \"53\",\n")]),_c('span',[_v("    \"category_id\": \"1234\",\n")]),_c('span',[_v("    \"total_sold\": \"90000\",\n")]),_c('span',[_v("    \"product_id\": \"200\",\n")]),_c('span',[_v("},\n")]),_c('span',[_v("{\n")]),_c('span',[_v("    \"id\": \"75\",\n")]),_c('span',[_v("    \"category_id\": \"1234\",\n")]),_c('span',[_v("    \"total_sold\": \"80000\",\n")]),_c('span',[_v("    \"product_id\": \"3\",\n")]),_c('span',[_v("},\n")])])]),_c('p',[_v("而对于服务器内部的通信，我们可以使用 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AErpc"}},[_v("RPC")]),_v("。")]),_v(" "),_c('h2',{attrs:{"id":"-12"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-12"}}),_v("第四步：架构扩展"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-12","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("根据限制条件，找到并解决瓶颈。")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/MzExP06.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/MzExP06.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("重要提示：不要从最初设计直接跳到最终设计中！")])]),_v(" "),_c('p',[_v("现在你要 1) "),_c('strong',[_v("基准测试、负载测试")]),_v("。2) "),_c('strong',[_v("分析、描述")]),_v("性能瓶颈。3) 在解决瓶颈问题的同时，评估替代方案、权衡利弊。4) 重复以上步骤。请阅读"),_c('a',{attrs:{"href":"/mazx4960.github.io/system-design-primer/solutions/system_design/scaling_aws/README.html"}},[_v("「设计一个系统，并将其扩大到为数以百万计的 AWS 用户服务」")]),_v(" 来了解如何逐步扩大初始设计。")]),_v(" "),_c('p',[_v("讨论初始设计可能遇到的瓶颈及相关解决方案是很重要的。例如加上一个配置多台 "),_c('strong',[_v("Web 服务器")]),_v("的"),_c('strong',[_v("负载均衡器")]),_v("是否能够解决问题？"),_c('strong',[_v("CDN")]),_v("呢？"),_c('strong',[_v("主从复制")]),_v("呢？它们各自的替代方案和需要"),_c('strong',[_v("权衡")]),_v("的利弊又有什么呢？")]),_v(" "),_c('p',[_v("我们将会介绍一些组件来完成设计，并解决架构扩张问题。内置的负载均衡器将不做讨论以节省篇幅。")]),_v(" "),_c('p',[_c('strong',[_v("为了避免重复讨论")]),_v("，请参考"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95"}},[_v("系统设计主题索引")]),_v("相关部分来了解其要点、方案的权衡取舍以及可选的替代方案。")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F"}},[_v("DNS")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8"}},[_v("负载均衡器")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B0%B4%E5%B9%B3%E6%89%A9%E5%B1%95"}},[_v("水平拓展")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"}},[_v("反向代理（web 服务器）")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E5%B1%82"}},[_v("API 服务（应用层）")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98"}},[_v("缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Frdbms"}},[_v("关系型数据库管理系统 (RDBMS)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%85%E9%9A%9C%E5%88%87%E6%8D%A2"}},[_v("SQL 故障主从切换")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"}},[_v("主从复制")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%80%E8%87%B4%E6%80%A7%E6%A8%A1%E5%BC%8F"}},[_v("一致性模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%AF%E7%94%A8%E6%80%A7%E6%A8%A1%E5%BC%8F"}},[_v("可用性模式")])])]),_v(" "),_c('p',[_c('strong',[_v("分析数据库")]),_v(" 可以用现成的数据仓储系统，例如使用 Amazon Redshift 或者 Google BigQuery 的解决方案。")]),_v(" "),_c('p',[_v("当使用数据仓储技术或者"),_c('strong',[_v("对象存储")]),_v("系统时，我们只想在数据库中存储有限时间段的数据。Amazon S3 的"),_c('strong',[_v("对象存储")]),_v("系统可以很方便地设置每个月限制只允许新增 40 GB 的存储内容。")]),_v(" "),_c('p',[_v("平均每秒 40,000 次的读取请求（峰值将会更高）, 可以通过扩展 "),_c('strong',[_v("内存缓存")]),_v(" 来处理热点内容的读取流量，这对于处理不均匀分布的流量和流量峰值也很有用。由于读取量非常大，"),_c('strong',[_v("SQL Read 副本")]),_v(" 可能会遇到处理缓存未命中的问题，我们可能需要使用额外的 SQL 扩展模式。")]),_v(" "),_c('p',[_v("平均每秒 400 次写操作（峰值将会更高）可能对于单个 "),_c('strong',[_v("SQL 写主-从")]),_v(" 模式来说比较很困难，因此同时还需要更多的扩展技术")]),_v(" "),_c('p',[_v("SQL 缩放模式包括：")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%81%94%E5%90%88"}},[_v("联合")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%86%E7%89%87"}},[_v("分片")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%9D%9E%E8%A7%84%E8%8C%83%E5%8C%96"}},[_v("非规范化")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%B0%83%E4%BC%98"}},[_v("SQL 调优")])])]),_v(" "),_c('p',[_v("我们也可以考虑将一些数据移至 "),_c('strong',[_v("NoSQL 数据库")]),_v("。")]),_v(" "),_c('h2',{attrs:{"id":"-13"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-13"}}),_v("其它要点"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-13","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("是否深入这些额外的主题，取决于你的问题范围和剩下的时间。")])]),_v(" "),_c('h4',{attrs:{"id":"nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nosql"}}),_v("NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%94%AE-%E5%80%BC%E5%AD%98%E5%82%A8"}},[_v("键-值存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%96%87%E6%A1%A3%E7%B1%BB%E5%9E%8B%E5%AD%98%E5%82%A8"}},[_v("文档类型存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%97%E5%9E%8B%E5%AD%98%E5%82%A8"}},[_v("列型存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93"}},[_v("图数据库")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%BF%98%E6%98%AF-nosql"}},[_v("SQL vs NoSQL")])])]),_v(" "),_c('h3',{attrs:{"id":"-14"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-14"}}),_v("缓存"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-14","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("在哪缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%93%E5%AD%98"}},[_v("客户端缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#cdn-%E7%BC%93%E5%AD%98"}},[_v("CDN 缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#web-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98"}},[_v("Web 服务器缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%93%E5%AD%98"}},[_v("数据库缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98"}},[_v("应用缓存")])])])]),_v(" "),_c('li',[_v("什么需要缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98"}},[_v("数据库查询级别的缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AF%B9%E8%B1%A1%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98"}},[_v("对象级别的缓存")])])])]),_v(" "),_c('li',[_v("何时更新缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98%E6%A8%A1%E5%BC%8F"}},[_v("缓存模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%9B%B4%E5%86%99%E6%A8%A1%E5%BC%8F"}},[_v("直写模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%9E%E5%86%99%E6%A8%A1%E5%BC%8F"}},[_v("回写模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%B7%E6%96%B0"}},[_v("刷新")])])])])]),_v(" "),_c('h3',{attrs:{"id":"-15"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-15"}}),_v("异步与微服务"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-15","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"}},[_v("消息队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97"}},[_v("任务队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%83%8C%E5%8E%8B"}},[_v("背压")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BE%AE%E6%9C%8D%E5%8A%A1"}},[_v("微服务")])])]),_v(" "),_c('h3',{attrs:{"id":"-16"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-16"}}),_v("通信"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-16","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("可权衡选择的方案：\n"),_c('ul',[_c('li',[_v("与客户端的外部通信 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%A1%A8%E8%BF%B0%E6%80%A7%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BBrest"}},[_v("使用 REST 作为 HTTP API")])]),_v(" "),_c('li',[_v("服务器内部通信 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AErpc"}},[_v("RPC")])])])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0"}},[_v("服务发现")])])]),_v(" "),_c('h3',{attrs:{"id":"-17"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-17"}}),_v("安全性"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-17","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("请参阅"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%89%E5%85%A8"}},[_v("「安全」")]),_v("一章。")]),_v(" "),_c('h3',{attrs:{"id":"-18"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-18"}}),_v("延迟数值"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-18","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("请参阅"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%AF%8F%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%91%98%E9%83%BD%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%95%B0"}},[_v("「每个程序员都应该知道的延迟数」")]),_v("。")]),_v(" "),_c('h3',{attrs:{"id":"-19"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-19"}}),_v("持续探讨"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-19","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("持续进行基准测试并监控你的系统，以解决他们提出的瓶颈问题。")]),_v(" "),_c('li',[_v("架构拓展是一个迭代的过程。")])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 3.1.1")]),_v("]")])])])}
}];
  