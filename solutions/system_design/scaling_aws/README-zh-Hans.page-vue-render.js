
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"fixed":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"brand",fn:function(){return [_c('a',{staticClass:"navbar-brand",attrs:{"href":"/index.html","title":"Home"}},[_v("System Design Primer")])]},proxy:true},{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_v(" "),_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Solutions")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/mint/readme.html"}},[_v("mint")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/pastebin/readme.html"}},[_v("pastebin")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/query_cache/readme.html"}},[_v("query_cache")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/sales_rank/readme.html"}},[_v("sales_rank")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/scaling_aws/readme.html"}},[_v("scaling_aws")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/social_graph/readme.html"}},[_v("social_graph")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/twitter/readme.html"}},[_v("twitter")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/web_crawler/readme.html"}},[_v("web_crawler")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"font-weight-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Topics")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Preface\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Motivation.html"}},[_v("Motivation")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Ankiflashcards.html"}},[_v("Anki flashcards")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Indexof-system-design-topics.html"}},[_v("Index")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Studyguide.html"}},[_v("Study Guide")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Interview Questions\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Howto-approach-a-system-design-interview-question.html"}},[_v("How to approach a system design interview question")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Object-orienteddesign-interview-questions-with-solutions.html"}},[_v("OOP interview questions")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Systemdesign-interview-questions-with-solutions.html"}},[_v("System design interview questions")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Systemdesign-topics-start-here.html"}},[_v("System design topics")]),_v(" "),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Performancevs-scalability.html"}},[_v("Performance vs scalability")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Latencyvs-throughput.html"}},[_v("Latency vs throughput")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Availabilityvs-consistency.html"}},[_v("Availability vs consistency")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Consistencypatterns.html"}},[_v("Consistency patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Availabilitypatterns.html"}},[_v("Availability patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Domainname-system.html"}},[_v("Domain name system")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contentdelivery-network.html"}},[_v("Content delivery network")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Loadbalancer.html"}},[_v("Load balancer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Reverseproxy-(web-server).html"}},[_v("Reverse proxy (web server)")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Applicationlayer.html"}},[_v("Application layer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Database.html"}},[_v("Database")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Cache.html"}},[_v("Cache")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Asynchronism.html"}},[_v("Asynchronism")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Communication.html"}},[_v("Communication")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Security.html"}},[_v("Security")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Misc\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Appendix.html"}},[_v("Appendix")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Underdevelopment.html"}},[_v("Under development")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Credits.html"}},[_v("Credits")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contactinfo.html"}},[_v("Contact info")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contributing.html"}},[_v("Contributing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/License.html"}},[_v("License")])])])])])])],1)],1)]),_v(" "),_m(0),_v(" "),_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"})])],1),_v(" "),_m(1)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('div',{staticClass:"fixed-header-padding",attrs:{"id":"content-wrapper"}},[_c('h1',{attrs:{"id":"aws"}},[_c('span',{staticClass:"anchor",attrs:{"id":"aws"}}),_v("在 AWS 上设计支持百万级到千万级用户的系统"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#aws","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("注释：为了避免重复，这篇文章的链接直接关联到 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#index-of-system-design-topics"}},[_v("系统设计主题")]),_v(" 的相关章节。为一讨论要点、折中方案和可选方案做参考。")])]),_v(" "),_c('h2',{attrs:{"id":"1"}},[_c('span',{staticClass:"anchor",attrs:{"id":"1"}}),_v("第 1 步：用例和约束概要"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#1","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("收集需求并调查问题。\n通过提问清晰用例和约束。\n讨论假设。")])]),_v(" "),_c('p',[_v("如果没有面试官提出明确的问题，我们将自己定义一些用例和约束条件。")]),_v(" "),_c('h3',{attrs:{"id":""}},[_v("用例")]),_v(" "),_c('p',[_v("解决这个问题是一个循序渐进的过程：1) "),_c('strong',[_v("基准/负载 测试")]),_v("， 2) 瓶颈 "),_c('strong',[_v("概述")]),_v("， 3) 当评估可选和折中方案时定位瓶颈，4) 重复，这是向可扩展的设计发展基础设计的好模式。")]),_v(" "),_c('p',[_v("除非你有 AWS 的背景或者正在申请需要 AWS 知识的相关职位，否则不要求了解 AWS 的相关细节。并且，这个练习中讨论的许多原则可以更广泛地应用于AWS生态系统之外。")]),_v(" "),_c('h4',{attrs:{"id":"-2"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-2"}}),_v("我们就处理以下用例讨论这一问题"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-2","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("用户")]),_v(" 进行读或写请求\n"),_c('ul',[_c('li',[_c('strong',[_v("服务")]),_v(" 进行处理，存储用户数据，然后返回结果")])])]),_v(" "),_c('li',[_c('strong',[_v("服务")]),_v(" 需要从支持小规模用户开始到百万用户\n"),_c('ul',[_c('li',[_v("在我们演化架构来处理大量的用户和请求时，讨论一般的扩展模式")])])]),_v(" "),_c('li',[_c('strong',[_v("服务")]),_v(" 高可用")])]),_v(" "),_c('h3',{attrs:{"id":"-3"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-3"}}),_v("约束和假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-3","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-4"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-4"}}),_v("状态假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-4","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("流量不均匀分布")]),_v(" "),_c('li',[_v("需要关系数据")]),_v(" "),_c('li',[_v("从一个用户扩展到千万用户\n"),_c('ul',[_c('li',[_v("表示用户量的增长\n"),_c('ul',[_c('li',[_v("用户量+")]),_v(" "),_c('li',[_v("用户量++")]),_v(" "),_c('li',[_v("用户量+++")]),_v(" "),_c('li',[_v("...")])])]),_v(" "),_c('li',[_v("1000 万用户")]),_v(" "),_c('li',[_v("每月 10 亿次写入")]),_v(" "),_c('li',[_v("每月 1000 亿次读出")]),_v(" "),_c('li',[_v("100:1 读写比率")]),_v(" "),_c('li',[_v("每次写入 1 KB 内容")])])])]),_v(" "),_c('h4',{attrs:{"id":"-5"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-5"}}),_v("计算使用"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-5","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("向你的面试官厘清你是否应该做粗略的使用计算")])]),_v(" "),_c('ul',[_c('li',[_v("1 TB 新内容 / 月\n"),_c('ul',[_c('li',[_v("1 KB 每次写入 * 10 亿 写入 / 月")]),_v(" "),_c('li',[_v("36 TB 新内容 / 3 年")]),_v(" "),_c('li',[_v("假设大多数写入都是新内容而不是更新已有内容")])])]),_v(" "),_c('li',[_v("平均每秒 400 次写入")]),_v(" "),_c('li',[_v("平均每秒 40,000 次读取")])]),_v(" "),_c('p',[_v("便捷的转换指南：")]),_v(" "),_c('ul',[_c('li',[_v("250 万秒 / 月")]),_v(" "),_c('li',[_v("1 次请求 / 秒 = 250 万次请求 / 月")]),_v(" "),_c('li',[_v("40 次请求 / 秒 = 1 亿次请求 / 月")]),_v(" "),_c('li',[_v("400 次请求 / 秒 = 10 亿请求 / 月")])]),_v(" "),_c('h2',{attrs:{"id":"2"}},[_c('span',{staticClass:"anchor",attrs:{"id":"2"}}),_v("第 2 步：创建高级设计方案"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#2","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("用所有重要组件概述高水平设计")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/B8LDKD7.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/B8LDKD7.png","alt":""}})])]),_v(" "),_c('h2',{attrs:{"id":"3"}},[_c('span',{staticClass:"anchor",attrs:{"id":"3"}}),_v("第 3 步：设计核心组件"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#3","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("深入每个核心组件的细节。")])]),_v(" "),_c('h3',{attrs:{"id":"-6"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-6"}}),_v("用例：用户进行读写请求"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-6","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-7"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-7"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-7","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("只有 1-2 个用户时，你只需要基础配置\n"),_c('ul',[_c('li',[_v("为简单起见，只需要一台服务器")]),_v(" "),_c('li',[_v("必要时进行纵向扩展")]),_v(" "),_c('li',[_v("监控以确定瓶颈")])])])]),_v(" "),_c('h4',{attrs:{"id":"-8"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-8"}}),_v("以单台服务器开始"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-8","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("Web 服务器")]),_v(" 在 EC2 上\n"),_c('ul',[_c('li',[_v("存储用户数据")]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms"}},[_c('strong',[_v("MySQL 数据库")])])])])])]),_v(" "),_c('p',[_v("运用 "),_c('strong',[_v("纵向扩展")]),_v("：")]),_v(" "),_c('ul',[_c('li',[_v("选择一台更大容量的服务器")]),_v(" "),_c('li',[_v("密切关注指标，确定如何扩大规模\n"),_c('ul',[_c('li',[_v("使用基本监控来确定瓶颈:CPU、内存、IO、网络等")]),_v(" "),_c('li',[_v("CloudWatch, top, nagios, statsd, graphite等")])])]),_v(" "),_c('li',[_v("纵向扩展的代价将变得更昂贵")]),_v(" "),_c('li',[_v("无冗余/容错")])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("纵向扩展")]),_v(" 的可选方案是 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#horizontal-scaling"}},[_c('strong',[_v("横向扩展")])])])]),_v(" "),_c('h4',{attrs:{"id":"sql-nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"sql-nosql"}}),_v("自 SQL 开始，但认真考虑 NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#sql-nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("约束条件假设需要关系型数据。我们可以开始时在单台服务器上使用 "),_c('strong',[_v("MySQL 数据库")]),_v("。")]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms"}},[_v("关系型数据库管理系统 (RDBMS)")]),_v(" 章节")]),_v(" "),_c('li',[_v("讨论使用 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-or-nosql"}},[_v("SQL 或 NoSQL")]),_v(" 的原因")])]),_v(" "),_c('h4',{attrs:{"id":"ip"}},[_c('span',{staticClass:"anchor",attrs:{"id":"ip"}}),_v("分配公共静态 IP"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#ip","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("弹性 IP 提供了一个公共端点，不会在重启时改变 IP。")]),_v(" "),_c('li',[_v("故障转移时只需要把域名指向新 IP。")])]),_v(" "),_c('h4',{attrs:{"id":"dns"}},[_c('span',{staticClass:"anchor",attrs:{"id":"dns"}}),_v("使用 DNS 服务"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#dns","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("添加 "),_c('strong',[_v("DNS")]),_v(" 服务，比如 Route 53（"),_c('a',{attrs:{"href":"https://aws.amazon.com/cn/route53/"}},[_v("Amazon Route 53")]),_v(" - 译者注），将域映射到实例的公共 IP 中。")]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#domain-name-system"}},[_v("域名系统")]),_v(" 章节")])]),_v(" "),_c('h4',{attrs:{"id":"web"}},[_c('span',{staticClass:"anchor",attrs:{"id":"web"}}),_v("安全的 Web 服务器"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#web","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("只开放必要的端口\n"),_c('ul',[_c('li',[_v("允许 Web 服务器响应来自以下端口的请求\n"),_c('ul',[_c('li',[_v("HTTP 80")]),_v(" "),_c('li',[_v("HTTPS 443")]),_v(" "),_c('li',[_v("SSH IP 白名单 22")])])]),_v(" "),_c('li',[_v("防止 Web 服务器启动外链")])])])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#security"}},[_v("安全")]),_v(" 章节")])]),_v(" "),_c('h2',{attrs:{"id":"4"}},[_c('span',{staticClass:"anchor",attrs:{"id":"4"}}),_v("第 4 步：扩展设计"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#4","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("在给定约束条件下，定义和确认瓶颈。")])]),_v(" "),_c('h3',{attrs:{"id":"-9"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-9"}}),_v("用户+"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-9","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/rrfjMXB.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/rrfjMXB.png","alt":""}})])]),_v(" "),_c('h4',{attrs:{"id":"-10"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-10"}}),_v("假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-10","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("我们的用户数量开始上升，并且单台服务器的负载上升。"),_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("分析")]),_v(" 指出 "),_c('strong',[_v("MySQL 数据库")]),_v(" 占用越来越多的内存和 CPU 资源，同时用户数据将填满硬盘空间。")]),_v(" "),_c('p',[_v("目前，我们尚能在纵向扩展时解决这些问题。不幸的是，解决这些问题的代价变得相当昂贵，并且原来的系统并不能允许在 "),_c('strong',[_v("MySQL 数据库")]),_v(" 和 "),_c('strong',[_v("Web 服务器")]),_v(" 的基础上进行独立扩展。")]),_v(" "),_c('h4',{attrs:{"id":"-11"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-11"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-11","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("减轻单台服务器负载并且允许独立扩展\n"),_c('ul',[_c('li',[_v("在 "),_c('strong',[_v("对象存储")]),_v(" 中单独存储静态内容")]),_v(" "),_c('li',[_v("将 "),_c('strong',[_v("MySQL 数据库")]),_v(" 迁移到单独的服务器上")])])]),_v(" "),_c('li',[_v("缺点\n"),_c('ul',[_c('li',[_v("这些变化会增加复杂性，并要求对 "),_c('strong',[_v("Web服务器")]),_v(" 进行更改，以指向 "),_c('strong',[_v("对象存储")]),_v(" 和 "),_c('strong',[_v("MySQL 数据库")])]),_v(" "),_c('li',[_v("必须采取额外的安全措施来确保新组件的安全")]),_v(" "),_c('li',[_v("AWS 的成本也会增加，但应该与自身管理类似系统的成本做比较")])])])]),_v(" "),_c('h4',{attrs:{"id":"-12"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-12"}}),_v("独立保存静态内容"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-12","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("考虑使用像 S3 这样可管理的 "),_c('strong',[_v("对象存储")]),_v(" 服务来存储静态内容\n"),_c('ul',[_c('li',[_v("高扩展性和可靠性")]),_v(" "),_c('li',[_v("服务器端加密")])])]),_v(" "),_c('li',[_v("迁移静态内容到 S3\n"),_c('ul',[_c('li',[_v("用户文件")]),_v(" "),_c('li',[_v("JS")]),_v(" "),_c('li',[_v("CSS")]),_v(" "),_c('li',[_v("图片")]),_v(" "),_c('li',[_v("视频")])])])]),_v(" "),_c('h4',{attrs:{"id":"mysql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"mysql"}}),_v("迁移 MySQL 数据库到独立机器上"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#mysql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("考虑使用类似 RDS 的服务来管理 "),_c('strong',[_v("MySQL 数据库")]),_v(" "),_c('ul',[_c('li',[_v("简单的管理，扩展")]),_v(" "),_c('li',[_v("多个可用区域")]),_v(" "),_c('li',[_v("空闲时加密")])])])]),_v(" "),_c('h4',{attrs:{"id":"-13"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-13"}}),_v("系统安全"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-13","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("在传输和空闲时对数据进行加密")]),_v(" "),_c('li',[_v("使用虚拟私有云\n"),_c('ul',[_c('li',[_v("为单个 "),_c('strong',[_v("Web 服务器")]),_v(" 创建一个公共子网，这样就可以发送和接收来自 internet 的流量")]),_v(" "),_c('li',[_v("为其他内容创建一个私有子网，禁止外部访问")]),_v(" "),_c('li',[_v("在每个组件上只为白名单 IP 打开端口")])])]),_v(" "),_c('li',[_v("这些相同的模式应当在新的组件的实现中实践")])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#security"}},[_v("安全")]),_v(" 章节")])]),_v(" "),_c('h3',{attrs:{"id":"-14"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-14"}}),_v("用户+++"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-14","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/raoFTXM.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/raoFTXM.png","alt":""}})])]),_v(" "),_c('h4',{attrs:{"id":"-15"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-15"}}),_v("假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-15","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("我们的 "),_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("性能测试")]),_v(" 显示，在高峰时段，我们的单一 "),_c('strong',[_v("Web服务器")]),_v(" 存在瓶颈，导致响应缓慢，在某些情况下还会宕机。随着服务的成熟，我们也希望朝着更高的可用性和冗余发展。")]),_v(" "),_c('h4',{attrs:{"id":"-16"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-16"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-16","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("下面的目标试图用 "),_c('strong',[_v("Web服务器")]),_v(" 解决扩展问题\n"),_c('ul',[_c('li',[_v("基于 "),_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("分析")]),_v("，你可能只需要实现其中的一两个技术")])])]),_v(" "),_c('li',[_v("使用 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#horizontal-scaling"}},[_c('strong',[_v("横向扩展")])]),_v(" 来处理增加的负载和单点故障\n"),_c('ul',[_c('li',[_v("添加 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#load-balancer"}},[_c('strong',[_v("负载均衡器")])]),_v(" 例如 Amazon 的 ELB 或 HAProxy\n"),_c('ul',[_c('li',[_v("ELB 是高可用的")]),_v(" "),_c('li',[_v("如果你正在配置自己的 "),_c('strong',[_v("负载均衡器")]),_v(", 在多个可用区域中设置多台服务器用于 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#active-active"}},[_v("双活")]),_v(" 或 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#active-passive"}},[_v("主被")]),_v(" 将提高可用性")]),_v(" "),_c('li',[_v("终止在 "),_c('strong',[_v("负载平衡器")]),_v(" 上的SSL，以减少后端服务器上的计算负载，并简化证书管理")])])]),_v(" "),_c('li',[_v("在多个可用区域中使用多台 "),_c('strong',[_v("Web服务器")])]),_v(" "),_c('li',[_v("在多个可用区域的 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#master-slave-replication"}},[_c('strong',[_v("主-从 故障转移")])]),_v(" 模式中使用多个 "),_c('strong',[_v("MySQL")]),_v(" 实例来改进冗余")])])]),_v(" "),_c('li',[_v("分离 "),_c('strong',[_v("Web 服务器")]),_v(" 和 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-layer"}},[_c('strong',[_v("应用服务器")])]),_v(" "),_c('ul',[_c('li',[_v("独立扩展和配置每一层")]),_v(" "),_c('li',[_c('strong',[_v("Web 服务器")]),_v(" 可以作为 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server"}},[_c('strong',[_v("反向代理")])])]),_v(" "),_c('li',[_v("例如, 你可以添加 "),_c('strong',[_v("应用服务器")]),_v(" 处理 "),_c('strong',[_v("读 API")]),_v(" 而另外一些处理 "),_c('strong',[_v("写 API")])])])]),_v(" "),_c('li',[_v("将静态（和一些动态）内容转移到 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#content-delivery-network"}},[_c('strong',[_v("内容分发网络 (CDN)")])]),_v(" 例如 CloudFront 以减少负载和延迟")])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅以上链接获得更多细节")])]),_v(" "),_c('h3',{attrs:{"id":"-17"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-17"}}),_v("用户+++"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-17","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/OZCxJr0.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/OZCxJr0.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("注意：")]),_v(" "),_c('strong',[_v("内部负载均衡")]),_v(" 不显示以减少混乱")]),_v(" "),_c('h4',{attrs:{"id":"-18"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-18"}}),_v("假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-18","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("我们的 "),_c('strong',[_v("性能/负载测试")]),_v(" 和 "),_c('strong',[_v("性能测试")]),_v(" 显示我们读操作频繁（100:1 的读写比率），并且数据库在高读请求时表现很糟糕。")]),_v(" "),_c('h4',{attrs:{"id":"-19"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-19"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-19","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("下面的目标试图解决 "),_c('strong',[_v("MySQL数据库")]),_v(" 的伸缩性问题\n"),_c('ul',[_c('li',[_c('ul',[_c('li',[_v("基于 "),_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("分析")]),_v("，你可能只需要实现其中的一两个技术")])])])])]),_v(" "),_c('li',[_v("将下列数据移动到一个 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache"}},[_c('strong',[_v("内存缓存")])]),_v("，例如弹性缓存，以减少负载和延迟：\n"),_c('ul',[_c('li',[_c('strong',[_v("MySQL")]),_v(" 中频繁访问的内容\n"),_c('ul',[_c('li',[_v("首先, 尝试配置 "),_c('strong',[_v("MySQL 数据库")]),_v(" 缓存以查看是否足以在实现 "),_c('strong',[_v("内存缓存")]),_v(" 之前缓解瓶颈")])])]),_v(" "),_c('li',[_v("来自 "),_c('strong',[_v("Web 服务器")]),_v(" 的会话数据\n"),_c('ul',[_c('li',[_c('strong',[_v("Web 服务器")]),_v(" 变成无状态的, 允许 "),_c('strong',[_v("自动伸缩")])])])]),_v(" "),_c('li',[_v("从内存中读取 1 MB 内存需要大约 250 微秒，而从SSD中读取时间要长 4 倍，从磁盘读取的时间要长 80 倍。"),_c('sup',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("1")])])])])]),_v(" "),_c('li',[_v("添加 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#master-slave-replication"}},[_c('strong',[_v("MySQL 读取副本")])]),_v(" 来减少写主线程的负载")]),_v(" "),_c('li',[_v("添加更多 "),_c('strong',[_v("Web 服务器")]),_v(" and "),_c('strong',[_v("应用服务器")]),_v(" 来提高响应")])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅以上链接获得更多细节")])]),_v(" "),_c('h4',{attrs:{"id":"mysql-2"}},[_c('span',{staticClass:"anchor",attrs:{"id":"mysql-2"}}),_v("添加 MySQL 读取副本"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#mysql-2","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("除了添加和扩展 "),_c('strong',[_v("内存缓存")]),_v("，"),_c('strong',[_v("MySQL 读副本服务器")]),_v(" 也能够帮助缓解在 "),_c('strong',[_v("MySQL 写主服务器")]),_v(" 的负载。")]),_v(" "),_c('li',[_v("添加逻辑到 "),_c('strong',[_v("Web 服务器")]),_v(" 来区分读和写操作")]),_v(" "),_c('li',[_v("在 "),_c('strong',[_v("MySQL 读副本服务器")]),_v(" 之上添加 "),_c('strong',[_v("负载均衡器")]),_v(" （不是为了减少混乱）")]),_v(" "),_c('li',[_v("大多数服务都是读取负载大于写入负载")])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms"}},[_v("关系型数据库管理系统 (RDBMS)")]),_v(" 章节")])]),_v(" "),_c('h3',{attrs:{"id":"-20"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-20"}}),_v("用户++++"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-20","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/3X8nmdL.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/3X8nmdL.png","alt":""}})])]),_v(" "),_c('h4',{attrs:{"id":"-21"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-21"}}),_v("假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-21","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("分析")]),_v(" 显示，在美国，正常工作时间存在流量峰值，当用户离开办公室时，流量骤降。我们认为，可以通过真实负载自动转换服务器数量来降低成本。我们是一家小商店，所以我们希望 DevOps 尽量自动化地进行 "),_c('strong',[_v("自动伸缩")]),_v(" 和通用操作。")]),_v(" "),_c('h4',{attrs:{"id":"-22"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-22"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-22","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("根据需要添加 "),_c('strong',[_v("自动扩展")]),_v(" "),_c('ul',[_c('li',[_v("跟踪流量高峰")]),_v(" "),_c('li',[_v("通过关闭未使用的实例来降低成本")])])]),_v(" "),_c('li',[_v("自动化 DevOps\n"),_c('ul',[_c('li',[_v("Chef, Puppet, Ansible 工具等")])])]),_v(" "),_c('li',[_v("继续监控指标以解决瓶颈\n"),_c('ul',[_c('li',[_c('strong',[_v("主机水平")]),_v(" - 检查一个 EC2 实例")]),_v(" "),_c('li',[_c('strong',[_v("总水平")]),_v(" - 检查负载均衡器统计数据")]),_v(" "),_c('li',[_c('strong',[_v("日志分析")]),_v(" - CloudWatch, CloudTrail, Loggly, Splunk, Sumo")]),_v(" "),_c('li',[_c('strong',[_v("外部站点的性能")]),_v(" - Pingdom or New Relic")]),_v(" "),_c('li',[_c('strong',[_v("处理通知和事件")]),_v(" - PagerDuty")]),_v(" "),_c('li',[_c('strong',[_v("错误报告")]),_v(" - Sentry")])])])]),_v(" "),_c('h4',{attrs:{"id":"-23"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-23"}}),_v("添加自动扩展"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-23","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("考虑使用一个托管服务，比如AWS "),_c('strong',[_v("自动扩展")]),_v(" "),_c('ul',[_c('li',[_v("为每个 "),_c('strong',[_v("Web 服务器")]),_v(" 创建一个组，并为每个 "),_c('strong',[_v("应用服务器")]),_v(" 类型创建一个组，将每个组放置在多个可用区域中")]),_v(" "),_c('li',[_v("设置最小和最大实例数")]),_v(" "),_c('li',[_v("通过 CloudWatch 来扩展或收缩\n"),_c('ul',[_c('li',[_v("可预测负载的简单时间度量")]),_v(" "),_c('li',[_v("一段时间内的指标：\n"),_c('ul',[_c('li',[_v("CPU 负载")]),_v(" "),_c('li',[_v("延迟")]),_v(" "),_c('li',[_v("网络流量")]),_v(" "),_c('li',[_v("自定义指标")])])])])]),_v(" "),_c('li',[_v("缺点\n"),_c('ul',[_c('li',[_v("自动扩展会引入复杂性")]),_v(" "),_c('li',[_v("可能需要一段时间才能适当扩大规模，以满足增加的需求，或者在需求下降时缩减规模")])])])])])]),_v(" "),_c('h3',{attrs:{"id":"-24"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-24"}}),_v("用户+++++"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-24","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/jj3A5N8.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/jj3A5N8.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("注释：")]),_v(" "),_c('strong',[_v("自动伸缩")]),_v(" 组不显示以减少混乱")]),_v(" "),_c('h4',{attrs:{"id":"-25"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-25"}}),_v("假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-25","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("当服务继续向着限制条件概述的方向发展，我们反复地运行 "),_c('strong',[_v("基准/负载测试")]),_v(" 和 "),_c('strong',[_v("分析")]),_v(" 来进一步发现和定位新的瓶颈。")]),_v(" "),_c('h4',{attrs:{"id":"-26"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-26"}}),_v("目标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-26","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("由于问题的约束，我们将继续提出扩展性的问题：")]),_v(" "),_c('ul',[_c('li',[_v("如果我们的 "),_c('strong',[_v("MySQL 数据库")]),_v(" 开始变得过于庞大, 我们可能只考虑把数据在数据库中存储一段有限的时间, 同时在例如 Redshift 这样的数据仓库中存储其余的数据\n"),_c('ul',[_c('li',[_v("像 Redshift 这样的数据仓库能够轻松处理每月 1TB 的新内容")])])]),_v(" "),_c('li',[_v("平均每秒 40,000 次的读取请求, 可以通过扩展 "),_c('strong',[_v("内存缓存")]),_v(" 来处理热点内容的读取流量，这对于处理不均匀分布的流量和流量峰值也很有用\n"),_c('ul',[_c('li',[_c('strong',[_v("SQL读取副本")]),_v(" 可能会遇到处理缓存未命中的问题, 我们可能需要使用额外的 SQL 扩展模式")])])]),_v(" "),_c('li',[_v("对于单个 "),_c('strong',[_v("SQL 写主-从")]),_v(" 模式来说，平均每秒 400 次写操作（明显更高）可能会很困难，同时还需要更多的扩展技术")])]),_v(" "),_c('p',[_v("SQL 扩展模型包括：")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#federation"}},[_v("集合")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sharding"}},[_v("分片")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#denormalization"}},[_v("反范式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-tuning"}},[_v("SQL 调优")])])]),_v(" "),_c('p',[_v("为了进一步处理高读和写请求，我们还应该考虑将适当的数据移动到一个 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#nosql"}},[_c('strong',[_v("NoSQL数据库")])]),_v(" ，例如 DynamoDB。")]),_v(" "),_c('p',[_v("我们可以进一步分离我们的 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-layer"}},[_c('strong',[_v("应用服务器")])]),_v(" 以允许独立扩展。不需要实时完成的批处理任务和计算可以通过 Queues 和 Workers 异步完成：")]),_v(" "),_c('ul',[_c('li',[_v("以照片服务为例，照片上传和缩略图的创建可以分开进行\n"),_c('ul',[_c('li',[_c('strong',[_v("客户端")]),_v(" 上传图片")]),_v(" "),_c('li',[_c('strong',[_v("应用服务器")]),_v(" 推送一个任务到 "),_c('strong',[_v("队列")]),_v(" 例如 SQS")]),_v(" "),_c('li',[_v("EC2 上的 "),_c('strong',[_v("Worker 服务")]),_v(" 或者 Lambda 从 "),_c('strong',[_v("队列")]),_v(" 拉取 work，然后：\n"),_c('ul',[_c('li',[_v("创建缩略图")]),_v(" "),_c('li',[_v("更新 "),_c('strong',[_v("数据库")])]),_v(" "),_c('li',[_v("在 "),_c('strong',[_v("对象存储")]),_v(" 中存储缩略图")])])])])])]),_v(" "),_c('p',[_c('strong',[_v("折中方案, 可选方案, 和其他细节:")])]),_v(" "),_c('ul',[_c('li',[_v("查阅以上链接获得更多细节")])]),_v(" "),_c('h2',{attrs:{"id":"-27"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-27"}}),_v("额外的话题"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-27","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("根据问题的范围和剩余时间，还需要深入讨论其他问题。")])]),_v(" "),_c('h3',{attrs:{"id":"sql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"sql"}}),_v("SQL 扩展模式"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#sql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#master-slave-replication"}},[_v("读取副本")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#federation"}},[_v("集合")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sharding"}},[_v("分区")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#denormalization"}},[_v("反规范化")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-tuning"}},[_v("SQL 调优")])])]),_v(" "),_c('h4',{attrs:{"id":"nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nosql"}}),_v("NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#key-value-store"}},[_v("键值存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#document-store"}},[_v("文档存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#wide-column-store"}},[_v("宽表存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#graph-database"}},[_v("图数据库")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-or-nosql"}},[_v("SQL vs NoSQL")])])]),_v(" "),_c('h3',{attrs:{"id":"-28"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-28"}}),_v("缓存"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-28","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("缓存到哪里\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#client-caching"}},[_v("客户端缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cdn-caching"}},[_v("CDN 缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#web-server-caching"}},[_v("Web 服务缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#database-caching"}},[_v("数据库缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-caching"}},[_v("应用缓存")])])])]),_v(" "),_c('li',[_v("缓存什么\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-database-query-level"}},[_v("数据库请求层缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-object-level"}},[_v("对象层缓存")])])])]),_v(" "),_c('li',[_v("何时更新缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache-aside"}},[_v("预留缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-through"}},[_v("完全写入")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-behind-write-back"}},[_v("延迟写 (写回)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#refresh-ahead"}},[_v("事先更新")])])])])]),_v(" "),_c('h3',{attrs:{"id":"-29"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-29"}}),_v("异步性和微服务"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-29","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#message-queues"}},[_v("消息队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#task-queues"}},[_v("任务队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#back-pressure"}},[_v("回退压力")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#microservices"}},[_v("微服务")])])]),_v(" "),_c('h3',{attrs:{"id":"-30"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-30"}}),_v("沟通"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-30","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("关于折中方案的讨论:\n"),_c('ul',[_c('li',[_v("客户端的外部通讯 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest"}},[_v("遵循 REST 的 HTTP APIs")])]),_v(" "),_c('li',[_v("内部通讯 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc"}},[_v("RPC")])])])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#service-discovery"}},[_v("服务探索")])])]),_v(" "),_c('h3',{attrs:{"id":"-31"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-31"}}),_v("安全性"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-31","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("参考 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#security"}},[_v("安全章节")])]),_v(" "),_c('h3',{attrs:{"id":"-32"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-32"}}),_v("延迟数字指标"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-32","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("查阅 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("每个程序员必懂的延迟数字")])]),_v(" "),_c('h3',{attrs:{"id":"-33"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-33"}}),_v("正在进行"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-33","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("继续基准测试并监控你的系统以解决出现的瓶颈问题")]),_v(" "),_c('li',[_v("扩展是一个迭代的过程")])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 3.1.1")]),_v("]")])])])}
}];
  