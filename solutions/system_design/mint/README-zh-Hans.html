<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="MarkBind 3.1.1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="stylesheet" href="../../../markbind/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../markbind/css/bootstrap-vue.min.css">
    <link rel="stylesheet" href="../../../markbind/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="../../../markbind/glyphicons/css/bootstrap-glyphicons.min.css">
    <link rel="stylesheet" href="../../../markbind/css/octicons.css">
    <link rel="stylesheet" href="../../../markbind/material-icons/material-icons.css">
    <link rel="stylesheet" href="../../../markbind/css/codeblock-dark.min.css"><link rel="stylesheet" href="../../../markbind/css/markbind.min.css"><script src="../../../markbind/js/polyfill.min.js"></script>
    <script src="../../../markbind/js/vue.min.js"></script>
    <script src="../../../markbind/js/markbind.min.js"></script>
    <script src="README-zh-Hans.page-vue-render.js"></script>
    <script src="../../../markbind/js/jquery.min.js"></script><link rel="stylesheet" href="https:/mazx4960.github.io/system-design-primer/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css">
    
  <link rel="stylesheet" href="https://mazx4960.github.io/system-design-primer//stylesheets/main.css">
</head>
<script>
  const baseUrl = 'https://mazx4960.github.io/system-design-primer/'
</script>
<body >
<div id="app" data-server-rendered="true"><header fixed=""><div data-v-15113a2f><nav class="navbar navbar-expand-md navbar-dark bg-dark" data-v-15113a2f><div class="container-fluid" data-v-15113a2f><div class="navbar-left" data-v-15113a2f><a href="https://mazx4960.github.io/system-design-primer//index.html" title="Home" class="navbar-brand" data-v-15113a2f>System Design Primer</a></div> <div class="navbar-default" data-v-15113a2f><ul class="navbar-nav mr-auto mt-2 mt-lg-0" data-v-15113a2f> <li class="nav-link dropdown" data-v-2e98b3f0><a role="button" class="dropdown-toggle" data-v-2e98b3f0>Solutions</a> <ul class="dropdown-menu" data-v-2e98b3f0> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/mint/README.html" class="dropdown-item" data-v-2e98b3f0>mint</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/pastebin/README.html" class="dropdown-item" data-v-2e98b3f0>pastebin</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/query_cache/README.html" class="dropdown-item" data-v-2e98b3f0>query_cache</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/sales_rank/README.html" class="dropdown-item" data-v-2e98b3f0>sales_rank</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/scaling_aws/README.html" class="dropdown-item" data-v-2e98b3f0>scaling_aws</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/social_graph/README.html" class="dropdown-item" data-v-2e98b3f0>social_graph</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/twitter/README.html" class="dropdown-item" data-v-2e98b3f0>twitter</a></li> <li data-v-2e98b3f0><a href="https://mazx4960.github.io/system-design-primer//solutions/system_design/web_crawler/README.html" class="dropdown-item" data-v-2e98b3f0>web_crawler</a></li></ul></li></ul></div> <ul class="navbar-nav navbar-right" data-v-15113a2f><li data-v-15113a2f><form class="navbar-form" data-v-15113a2f><div style="position:relative;"><input type="text" placeholder="Search" autocomplete="off" value="" class="form-control"> <ul class="dropdown-menu search-dropdown-menu dropdown-menu-right"></ul></div></form></li></ul></div></nav> <div class="lower-navbar-container" style="display:none;" data-v-15113a2f><!----> <!----></div></div></header> <div id="flex-body"><nav id="site-nav" class="fixed-header-padding" data-v-e8c82f88><div class="site-nav-top" data-v-e8c82f88><div class="font-weight-bold mb-2" style="font-size:1.25rem;" data-v-e8c82f88>Topics</div></div> <div class="nav-component slim-scroll" data-v-e8c82f88><div class="site-nav-root"><ul class="site-nav-list site-nav-list-root" data-v-e8c82f88><li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e8c82f88>Preface

<i onclick="handleSiteNavClick(this.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon" data-v-e8c82f88><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e8c82f88></span></i></div><ul class="site-nav-dropdown-container site-nav-list" data-v-e8c82f88><li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Motivation.html" data-v-e8c82f88>Motivation</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Ankiflashcards.html" data-v-e8c82f88>Anki flashcards</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Indexof-system-design-topics.html" data-v-e8c82f88>Index</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Studyguide.html" data-v-e8c82f88>Study Guide</a></div></li></ul></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e8c82f88>Interview Questions

<i onclick="handleSiteNavClick(this.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon" data-v-e8c82f88><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e8c82f88></span></i></div><ul class="site-nav-dropdown-container site-nav-list" data-v-e8c82f88><li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Howto-approach-a-system-design-interview-question.html" data-v-e8c82f88>How to approach a system design interview question</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Object-orienteddesign-interview-questions-with-solutions.html" data-v-e8c82f88>OOP interview questions</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Systemdesign-interview-questions-with-solutions.html" data-v-e8c82f88>System design interview questions</a></div></li></ul></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Systemdesign-topics-start-here.html" data-v-e8c82f88>System design topics</a> <i onclick="handleSiteNavClick(this.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon" data-v-e8c82f88><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e8c82f88></span></i></div><ul class="site-nav-dropdown-container site-nav-list" data-v-e8c82f88><li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Performancevs-scalability.html" data-v-e8c82f88>Performance vs scalability</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Latencyvs-throughput.html" data-v-e8c82f88>Latency vs throughput</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Availabilityvs-consistency.html" data-v-e8c82f88>Availability vs consistency</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Consistencypatterns.html" data-v-e8c82f88>Consistency patterns</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Availabilitypatterns.html" data-v-e8c82f88>Availability patterns</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Domainname-system.html" data-v-e8c82f88>Domain name system</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Contentdelivery-network.html" data-v-e8c82f88>Content delivery network</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Loadbalancer.html" data-v-e8c82f88>Load balancer</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Reverseproxy-(web-server).html" data-v-e8c82f88>Reverse proxy (web server)</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Applicationlayer.html" data-v-e8c82f88>Application layer</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Database.html" data-v-e8c82f88>Database</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Cache.html" data-v-e8c82f88>Cache</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Asynchronism.html" data-v-e8c82f88>Asynchronism</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Communication.html" data-v-e8c82f88>Communication</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Security.html" data-v-e8c82f88>Security</a></div></li></ul></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-0" data-v-e8c82f88>Misc

<i onclick="handleSiteNavClick(this.parentNode, false); event.stopPropagation();" class="site-nav-dropdown-btn-icon" data-v-e8c82f88><span aria-hidden="true" class="glyphicon glyphicon-menu-down" data-v-e8c82f88></span></i></div><ul class="site-nav-dropdown-container site-nav-list" data-v-e8c82f88><li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Appendix.html" data-v-e8c82f88>Appendix</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Underdevelopment.html" data-v-e8c82f88>Under development</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Credits.html" data-v-e8c82f88>Credits</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Contactinfo.html" data-v-e8c82f88>Contact info</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/Contributing.html" data-v-e8c82f88>Contributing</a></div></li> <li data-v-e8c82f88><div onclick="handleSiteNavClick(this)" class="site-nav-default-list-item site-nav-list-item-1" data-v-e8c82f88><a href="https://mazx4960.github.io/system-design-primer//contents/License.html" data-v-e8c82f88>License</a></div></li></ul></li> <!----></ul></div></div> <!----></nav> <div id="content-wrapper" class="fixed-header-padding"><h1 id="mint-com"><span id="mint-com" class="anchor"></span>设计 <a href="http://Mint.com">Mint.com</a><a href="#mint-com" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h1> <p><strong>注意：这个文档中的链接会直接指向<a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%B4%A2%E5%BC%95">系统设计主题索引</a>中的有关部分，以避免重复的内容。您可以参考链接的相关内容，来了解其总的要点、方案的权衡取舍以及可选的替代方案。</strong></p> <h2 id="">第一步：简述用例与约束条件</h2> <blockquote><p>搜集需求与问题的范围。
提出问题来明确用例与约束条件。
讨论假设。</p></blockquote> <p>我们将在没有面试官明确说明问题的情况下，自己定义一些用例以及限制条件。</p> <h3 id="-2"><span id="-2" class="anchor"></span>用例<a href="#-2" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <h4 id="-3"><span id="-3" class="anchor"></span>我们将把问题限定在仅处理以下用例的范围中<a href="#-3" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <ul><li><strong>用户</strong> 连接到一个财务账户</li> <li><strong>服务</strong> 从账户中提取交易
<ul><li>每日更新</li> <li>分类交易
<ul><li>允许用户手动分类</li> <li>不自动重新分类</li></ul></li> <li>按类别分析每月支出</li></ul></li> <li><strong>服务</strong> 推荐预算
<ul><li>允许用户手动设置预算</li> <li>当接近或者超出预算时，发送通知</li></ul></li> <li><strong>服务</strong> 具有高可用性</li></ul> <h4 id="-4"><span id="-4" class="anchor"></span>非用例范围<a href="#-4" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <ul><li><strong>服务</strong> 执行附加的日志记录和分析</li></ul> <h3 id="-5"><span id="-5" class="anchor"></span>限制条件与假设<a href="#-5" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <h4 id="-6"><span id="-6" class="anchor"></span>提出假设<a href="#-6" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <ul><li>网络流量非均匀分布</li> <li>自动账户日更新只适用于 30 天内活跃的用户</li> <li>添加或者移除财务账户相对较少</li> <li>预算通知不需要及时</li> <li>1000 万用户
<ul><li>每个用户10个预算类别= 1亿个预算项</li> <li>示例类别:
<ul><li>Housing = $1,000</li> <li>Food = $200</li> <li>Gas = $100</li></ul></li> <li>卖方确定交易类别
<ul><li>50000 个卖方</li></ul></li></ul></li> <li>3000 万财务账户</li> <li>每月 50 亿交易</li> <li>每月 5 亿读请求</li> <li>10:1 读写比
<ul><li>Write-heavy，用户每天都进行交易，但是每天很少访问该网站</li></ul></li></ul> <h4 id="-7"><span id="-7" class="anchor"></span>计算用量<a href="#-7" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <p><strong>如果你需要进行粗略的用量计算，请向你的面试官说明。</strong></p> <ul><li>每次交易的用量:
<ul><li><code class="hljs inline no-lang">user_id</code> - 8 字节</li> <li><code class="hljs inline no-lang">created_at</code> - 5 字节</li> <li><code class="hljs inline no-lang">seller</code> - 32 字节</li> <li><code class="hljs inline no-lang">amount</code> - 5 字节</li> <li>Total: ~50 字节</li></ul></li> <li>每月产生 250 GB 新的交易内容
<ul><li>每次交易 50 比特 * 50 亿交易每月</li> <li>3年内新的交易内容 9 TB</li> <li>Assume most are new transactions instead of updates to existing ones</li></ul></li> <li>平均每秒产生 2000 次交易</li> <li>平均每秒产生 200 读请求</li></ul> <p>便利换算指南：</p> <ul><li>每个月有 250 万秒</li> <li>每秒一个请求 = 每个月 250 万次请求</li> <li>每秒 40 个请求 = 每个月 1 亿次请求</li> <li>每秒 400 个请求 = 每个月 10 亿次请求</li></ul> <h2 id="-8"><span id="-8" class="anchor"></span>第二步：概要设计<a href="#-8" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <blockquote><p>列出所有重要组件以规划概要设计。</p></blockquote> <p><a href="http://i.imgur.com/E8klrBh.png" target="_self"><img src="http://i.imgur.com/E8klrBh.png" alt="" class="img-fluid"></a></p> <h2 id="-9"><span id="-9" class="anchor"></span>第三步：设计核心组件<a href="#-9" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <blockquote><p>深入每个核心组件的细节。</p></blockquote> <h3 id="-10"><span id="-10" class="anchor"></span>用例：用户连接到一个财务账户<a href="#-10" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>我们可以将 1000 万用户的信息存储在一个<a href="https://github.com/donnemartin/system-design-primer#relational-database-management-system-rdbms">关系数据库</a>中。我们应该讨论一下<a href="https://github.com/donnemartin/system-design-primer#sql-or-nosql">选择SQL或NoSQL之间的用例和权衡</a>了。</p> <ul><li><strong>客户端</strong> 作为一个<a href="https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server">反向代理</a>，发送请求到 <strong>Web 服务器</strong></li> <li><strong>Web 服务器</strong> 转发请求到 <strong>账户API</strong> 服务器</li> <li><strong>账户API</strong> 服务器将新输入的账户信息更新到 <strong>SQL数据库</strong> 的<code class="hljs inline no-lang">accounts</code>表</li></ul> <p><strong>告知你的面试官你准备写多少代码</strong>。</p> <p><code class="hljs inline no-lang">accounts</code>表应该具有如下结构：</p> <pre><code class="hljs"><span>id int NOT NULL AUTO_INCREMENT
</span><span>created_at datetime NOT NULL
</span><span>last_update datetime NOT NULL
</span><span>account_url varchar(255) NOT NULL
</span><span>account_login varchar(32) NOT NULL
</span><span>account_password_hash char(64) NOT NULL
</span><span>user_id int NOT NULL
</span><span>PRIMARY KEY(id)
</span><span>FOREIGN KEY(user_id) REFERENCES users(id)
</span></code></pre><p>我们将在<code class="hljs inline no-lang">id</code>，<code class="hljs inline no-lang">user_id</code>和<code class="hljs inline no-lang">created_at</code>等字段上创建一个<a href="https://github.com/donnemartin/system-design-primer#use-good-indices">索引</a>以加速查找（对数时间而不是扫描整个表）并保持数据在内存中。从内存中顺序读取 1 MB数据花费大约250毫秒，而从SSD读取是其4倍，从磁盘读取是其80倍。<sup><a href="https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know">1</a></sup></p> <p>我们将使用公开的<a href="https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest"><strong>REST API</strong></a>:</p> <pre><code class="hljs"><span>$ curl -X POST --data '{ &quot;user_id&quot;: &quot;foo&quot;, &quot;account_url&quot;: &quot;bar&quot;, \
</span><span>    &quot;account_login&quot;: &quot;baz&quot;, &quot;account_password&quot;: &quot;qux&quot; }' \
</span><span>    https://mint.com/api/v1/account
</span></code></pre><p>对于内部通信，我们可以使用<a href="https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc">远程过程调用</a>。</p> <p>接下来，服务从账户中提取交易。</p> <h3 id="-11"><span id="-11" class="anchor"></span>用例：服务从账户中提取交易<a href="#-11" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>如下几种情况下，我们会想要从账户中提取信息：</p> <ul><li>用户首次链接账户</li> <li>用户手动更新账户</li> <li>为过去 30 天内活跃的用户自动日更新</li></ul> <p>数据流:</p> <ul><li><strong>客户端</strong>向 <strong>Web服务器</strong> 发送请求</li> <li><strong>Web服务器</strong> 将请求转发到 <strong>帐户API</strong> 服务器</li> <li><strong>帐户API</strong> 服务器将job放在 <strong>队列</strong> 中，如 <a href="https://aws.amazon.com/sqs/">Amazon SQS</a> 或者 <a href="https://www.rabbitmq.com/">RabbitMQ</a> <ul><li>提取交易可能需要一段时间，我们可能希望<a href="https://github.com/donnemartin/system-design-primer#asynchronism">与队列异步</a>地来做，虽然这会引入额外的复杂度。</li></ul></li> <li><strong>交易提取服务</strong> 执行如下操作：
<ul><li>从 <strong>Queue</strong> 中拉取并从金融机构中提取给定用户的交易，将结果作为原始日志文件存储在 <strong>对象存储区</strong>。</li> <li>使用 <strong>分类服务</strong> 来分类每个交易</li> <li>使用 <strong>预算服务</strong> 来按类别计算每月总支出
<ul><li><strong>预算服务</strong> 使用 <strong>通知服务</strong> 让用户知道他们是否接近或者已经超出预算</li></ul></li> <li>更新具有分类交易的 <strong>SQL数据库</strong> 的<code class="hljs inline no-lang">transactions</code>表</li> <li>按类别更新 <strong>SQL数据库</strong> <code class="hljs inline no-lang">monthly_spending</code>表的每月总支出</li> <li>通过 <strong>通知服务</strong> 提醒用户交易完成
<ul><li>使用一个 <strong>队列</strong> (没有画出来) 来异步发送通知</li></ul></li></ul></li></ul> <p><code class="hljs inline no-lang">transactions</code>表应该具有如下结构：</p> <pre><code class="hljs"><span>id int NOT NULL AUTO_INCREMENT
</span><span>created_at datetime NOT NULL
</span><span>seller varchar(32) NOT NULL
</span><span>amount decimal NOT NULL
</span><span>user_id int NOT NULL
</span><span>PRIMARY KEY(id)
</span><span>FOREIGN KEY(user_id) REFERENCES users(id)
</span></code></pre><p>我们将在 <code class="hljs inline no-lang">id</code>，<code class="hljs inline no-lang">user_id</code>，和 <code class="hljs inline no-lang">created_at</code>字段上创建<a href="https://github.com/donnemartin/system-design-primer#use-good-indices">索引</a>。</p> <p><code class="hljs inline no-lang">monthly_spending</code>表应该具有如下结构：</p> <pre><code class="hljs"><span>id int NOT NULL AUTO_INCREMENT
</span><span>month_year date NOT NULL
</span><span>category varchar(32)
</span><span>amount decimal NOT NULL
</span><span>user_id int NOT NULL
</span><span>PRIMARY KEY(id)
</span><span>FOREIGN KEY(user_id) REFERENCES users(id)
</span></code></pre><p>我们将在<code class="hljs inline no-lang">id</code>，<code class="hljs inline no-lang">user_id</code>字段上创建<a href="https://github.com/donnemartin/system-design-primer#use-good-indices">索引</a>。</p> <h4 id="-12"><span id="-12" class="anchor"></span>分类服务<a href="#-12" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <p>对于 <strong>分类服务</strong>，我们可以生成一个带有最受欢迎卖家的卖家-类别字典。如果我们估计 50000 个卖家，并估计每个条目占用不少于 255 个字节，该字典只需要大约 12 MB内存。</p> <p><strong>告知你的面试官你准备写多少代码</strong>。</p> <pre><code class="hljs python"><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DefaultCategories</span>(<span class="hljs-params">Enum</span>):</span>
</span><span>
</span><span>    HOUSING = <span class="hljs-number">0</span>
</span><span>    FOOD = <span class="hljs-number">1</span>
</span><span>    GAS = <span class="hljs-number">2</span>
</span><span>    SHOPPING = <span class="hljs-number">3</span>
</span><span>    ...
</span><span>
</span><span>seller_category_map = {}
</span><span>seller_category_map[<span class="hljs-string">'Exxon'</span>] = DefaultCategories.GAS
</span><span>seller_category_map[<span class="hljs-string">'Target'</span>] = DefaultCategories.SHOPPING
</span><span>...
</span></code></pre><p>对于一开始没有在映射中的卖家，我们可以通过评估用户提供的手动类别来进行众包。在 O(1) 时间内，我们可以用堆来快速查找每个卖家的顶端的手动覆盖。</p> <pre><code class="hljs python"><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Categorizer</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, seller_category_map, self.seller_category_crowd_overrides_map</span>):</span>
</span><span>        self.seller_category_map = seller_category_map
</span><span>        self.seller_category_crowd_overrides_map = \
</span><span>            seller_category_crowd_overrides_map
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">categorize</span>(<span class="hljs-params">self, transaction</span>):</span>
</span><span>        <span class="hljs-keyword">if</span> transaction.seller <span class="hljs-keyword">in</span> self.seller_category_map:
</span><span>            <span class="hljs-keyword">return</span> self.seller_category_map[transaction.seller]
</span><span>        <span class="hljs-keyword">elif</span> transaction.seller <span class="hljs-keyword">in</span> self.seller_category_crowd_overrides_map:
</span><span>            self.seller_category_map[transaction.seller] = \
</span><span>                self.seller_category_crowd_overrides_map[transaction.seller].peek_min()
</span><span>            <span class="hljs-keyword">return</span> self.seller_category_map[transaction.seller]
</span><span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</span></code></pre><p>交易实现：</p> <pre><code class="hljs python"><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Transaction</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, created_at, seller, amount</span>):</span>
</span><span>        self.timestamp = timestamp
</span><span>        self.seller = seller
</span><span>        self.amount = amount
</span></code></pre><h3 id="-13"><span id="-13" class="anchor"></span>用例：服务推荐预算<a href="#-13" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>首先，我们可以使用根据收入等级分配每类别金额的通用预算模板。使用这种方法，我们不必存储在约束中标识的 1 亿个预算项目，只需存储用户覆盖的预算项目。如果用户覆盖预算类别，我们可以在
<code class="hljs inline no-lang">TABLE budget_overrides</code>中存储此覆盖。</p> <pre><code class="hljs python"><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Budget</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span>
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, income</span>):</span>
</span><span>        self.income = income
</span><span>        self.categories_to_budget_map = self.create_budget_template()
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_budget_template</span>(<span class="hljs-params">self</span>):</span>
</span><span>        <span class="hljs-keyword">return</span> {
</span><span>            <span class="hljs-string">'DefaultCategories.HOUSING'</span>: income * <span class="hljs-number">.4</span>,
</span><span>            <span class="hljs-string">'DefaultCategories.FOOD'</span>: income * <span class="hljs-number">.2</span>
</span><span>            <span class="hljs-string">'DefaultCategories.GAS'</span>: income * <span class="hljs-number">.1</span>,
</span><span>            <span class="hljs-string">'DefaultCategories.SHOPPING'</span>: income * <span class="hljs-number">.2</span>
</span><span>            ...
</span><span>        }
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">override_category_budget</span>(<span class="hljs-params">self, category, amount</span>):</span>
</span><span>        self.categories_to_budget_map[category] = amount
</span></code></pre><p>对于 <strong>预算服务</strong> 而言，我们可以在<code class="hljs inline no-lang">transactions</code>表上运行SQL查询以生成<code class="hljs inline no-lang">monthly_spending</code>聚合表。由于用户通常每个月有很多交易，所以<code class="hljs inline no-lang">monthly_spending</code>表的行数可能会少于总共50亿次交易的行数。</p> <p>作为替代，我们可以在原始交易文件上运行 <strong>MapReduce</strong> 作业来：</p> <ul><li>分类每个交易</li> <li>按类别生成每月总支出</li></ul> <p>对交易文件的运行分析可以显著减少数据库的负载。</p> <p>如果用户更新类别，我们可以调用 <strong>预算服务</strong> 重新运行分析。</p> <p><strong>告知你的面试官你准备写多少代码</strong>.</p> <p>日志文件格式样例，以tab分割：</p> <pre><code class="hljs"><span>user_id   timestamp   seller  amount
</span></code></pre><p><strong>MapReduce</strong> 实现:</p> <pre><code class="hljs python"><span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpendingByCategory</span>(<span class="hljs-params">MRJob</span>):</span>
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, categorizer</span>):</span>
</span><span>        self.categorizer = categorizer
</span><span>        self.current_year_month = calc_current_year_month()
</span><span>        ...
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_current_year_month</span>(<span class="hljs-params">self</span>):</span>
</span><span>        <span class="hljs-string">&quot;&quot;&quot;返回当前年月&quot;&quot;&quot;</span>
</span><span>        ...
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_year_month</span>(<span class="hljs-params">self, timestamp</span>):</span>
</span><span>        <span class="hljs-string">&quot;&quot;&quot;返回时间戳的年，月部分&quot;&quot;&quot;</span>
</span><span>        ...
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_budget_notifications</span>(<span class="hljs-params">self, key, total</span>):</span>
</span><span>        <span class="hljs-string">&quot;&quot;&quot;如果接近或超出预算，调用通知API&quot;&quot;&quot;</span>
</span><span>        ...
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">mapper</span>(<span class="hljs-params">self, _, line</span>):</span>
</span><span>        <span class="hljs-string">&quot;&quot;&quot;解析每个日志行，提取和转换相关行。</span>
</span><span><span class="hljs-string"></span>
</span><span><span class="hljs-string">        参数行应为如下形式：</span>
</span><span><span class="hljs-string"></span>
</span><span><span class="hljs-string">        user_id   timestamp   seller  amount</span>
</span><span><span class="hljs-string"></span>
</span><span><span class="hljs-string">        使用分类器来将卖家转换成类别，生成如下形式的key-value对：</span>
</span><span><span class="hljs-string"></span>
</span><span><span class="hljs-string">        (user_id, 2016-01, shopping), 25</span>
</span><span><span class="hljs-string">        (user_id, 2016-01, shopping), 100</span>
</span><span><span class="hljs-string">        (user_id, 2016-01, gas), 50</span>
</span><span><span class="hljs-string">        &quot;&quot;&quot;</span>
</span><span>        user_id, timestamp, seller, amount = line.split(<span class="hljs-string">'\t'</span>)
</span><span>        category = self.categorizer.categorize(seller)
</span><span>        period = self.extract_year_month(timestamp)
</span><span>        <span class="hljs-keyword">if</span> period == self.current_year_month:
</span><span>            <span class="hljs-keyword">yield</span> (user_id, period, category), amount
</span><span>
</span><span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">self, key, value</span>):</span>
</span><span>        <span class="hljs-string">&quot;&quot;&quot;将每个key对应的值求和。</span>
</span><span><span class="hljs-string"></span>
</span><span><span class="hljs-string">        (user_id, 2016-01, shopping), 125</span>
</span><span><span class="hljs-string">        (user_id, 2016-01, gas), 50</span>
</span><span><span class="hljs-string">        &quot;&quot;&quot;</span>
</span><span>        total = <span class="hljs-built_in">sum</span>(values)
</span><span>        <span class="hljs-keyword">yield</span> key, <span class="hljs-built_in">sum</span>(values)
</span></code></pre><h2 id="-14"><span id="-14" class="anchor"></span>第四步：设计扩展<a href="#-14" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <blockquote><p>根据限制条件，找到并解决瓶颈。</p></blockquote> <p><a href="http://i.imgur.com/V5q57vU.png" target="_self"><img src="http://i.imgur.com/V5q57vU.png" alt="" class="img-fluid"></a></p> <p><strong>重要提示：不要从最初设计直接跳到最终设计中！</strong></p> <p>现在你要 1) <strong>基准测试、负载测试</strong>。2) <strong>分析、描述</strong>性能瓶颈。3) 在解决瓶颈问题的同时，评估替代方案、权衡利弊。4) 重复以上步骤。请阅读<a href="/mazx4960.github.io/system-design-primer/solutions/system_design/scaling_aws/README.html">「设计一个系统，并将其扩大到为数以百万计的 AWS 用户服务」</a> 来了解如何逐步扩大初始设计。</p> <p>讨论初始设计可能遇到的瓶颈及相关解决方案是很重要的。例如加上一个配置多台 <strong>Web 服务器</strong>的<strong>负载均衡器</strong>是否能够解决问题？<strong>CDN</strong>呢？<strong>主从复制</strong>呢？它们各自的替代方案和需要<strong>权衡</strong>的利弊又有什么呢？</p> <p>我们将会介绍一些组件来完成设计，并解决架构扩张问题。内置的负载均衡器将不做讨论以节省篇幅。</p> <p><strong>为了避免重复讨论</strong>，请参考<a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95">系统设计主题索引</a>相关部分来了解其要点、方案的权衡取舍以及可选的替代方案。</p> <ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F">DNS</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8">负载均衡器</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B0%B4%E5%B9%B3%E6%89%A9%E5%B1%95">水平拓展</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8">反向代理（web 服务器）</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E5%B1%82">API 服务（应用层）</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98">缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Frdbms">关系型数据库管理系统 (RDBMS)</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%85%E9%9A%9C%E5%88%87%E6%8D%A2">SQL 故障主从切换</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">主从复制</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BC%82%E6%AD%A5">异步</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%80%E8%87%B4%E6%80%A7%E6%A8%A1%E5%BC%8F">一致性模式</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%AF%E7%94%A8%E6%80%A7%E6%A8%A1%E5%BC%8F">可用性模式</a></li></ul> <p>我们将增加一个额外的用例：<strong>用户</strong> 访问摘要和交易数据。</p> <p>用户会话，按类别统计的统计信息，以及最近的事务可以放在 <strong>内存缓存</strong>（如 Redis 或 Memcached ）中。</p> <ul><li><strong>客户端</strong> 发送读请求给 <strong>Web 服务器</strong></li> <li><strong>Web 服务器</strong> 转发请求到 <strong>读 API</strong> 服务器
<ul><li>静态内容可通过 <strong>对象存储</strong> 比如缓存在 <strong>CDN</strong> 上的 S3 来服务</li></ul></li> <li><strong>读 API</strong> 服务器做如下动作:
<ul><li>检查 <strong>内存缓存</strong> 的内容
<ul><li>如果URL在 <strong>内存缓存</strong>中，返回缓存的内容</li> <li>否则
<ul><li>如果URL在 <strong>SQL 数据库</strong>中，获取该内容
<ul><li>以其内容更新 <strong>内存缓存</strong></li></ul></li></ul></li></ul></li></ul></li></ul> <p>参考 <a href="https://github.com/donnemartin/system-design-primer#when-to-update-the-cache">何时更新缓存</a> 中权衡和替代的内容。以上方法描述了 <a href="https://github.com/donnemartin/system-design-primer#cache-aside">cache-aside缓存模式</a>.</p> <p>我们可以使用诸如 Amazon Redshift 或者 Google BigQuery 等数据仓库解决方案，而不是将<code class="hljs inline no-lang">monthly_spending</code>聚合表保留在 <strong>SQL 数据库</strong> 中。</p> <p>我们可能只想在数据库中存储一个月的<code class="hljs inline no-lang">交易</code>数据，而将其余数据存储在数据仓库或者 <strong>对象存储区</strong> 中。<strong>对象存储区</strong> （如Amazon S3) 能够舒服地解决每月 250 GB新内容的限制。</p> <p>为了解决每秒 <em>平均</em> 2000 次读请求数（峰值时更高），受欢迎的内容的流量应由 <strong>内存缓存</strong> 而不是数据库来处理。 <strong>内存缓存</strong> 也可用于处理不均匀分布的流量和流量尖峰。 只要副本不陷入重复写入的困境，<strong>SQL 读副本</strong> 应该能够处理高速缓存未命中。</p> <p><em>平均</em> 200 次交易写入每秒（峰值时更高）对于单个 <strong>SQL 写入主-从服务</strong> 来说可能是棘手的。我们可能需要考虑其它的 SQL 性能拓展技术：</p> <ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%81%94%E5%90%88">联合</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%86%E7%89%87">分片</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%9D%9E%E8%A7%84%E8%8C%83%E5%8C%96">非规范化</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%B0%83%E4%BC%98">SQL 调优</a></li></ul> <p>我们也可以考虑将一些数据移至 <strong>NoSQL 数据库</strong>。</p> <h2 id="-15"><span id="-15" class="anchor"></span>其它要点<a href="#-15" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h2> <blockquote><p>是否深入这些额外的主题，取决于你的问题范围和剩下的时间。</p></blockquote> <h4 id="nosql"><span id="nosql" class="anchor"></span>NoSQL<a href="#nosql" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h4> <ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%94%AE-%E5%80%BC%E5%AD%98%E5%82%A8">键-值存储</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%96%87%E6%A1%A3%E7%B1%BB%E5%9E%8B%E5%AD%98%E5%82%A8">文档类型存储</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%97%E5%9E%8B%E5%AD%98%E5%82%A8">列型存储</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93">图数据库</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%BF%98%E6%98%AF-nosql">SQL vs NoSQL</a></li></ul> <h3 id="-16"><span id="-16" class="anchor"></span>缓存<a href="#-16" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>在哪缓存
<ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%93%E5%AD%98">客户端缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#cdn-%E7%BC%93%E5%AD%98">CDN 缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#web-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98">Web 服务器缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%93%E5%AD%98">数据库缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98">应用缓存</a></li></ul></li> <li>什么需要缓存
<ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98">数据库查询级别的缓存</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AF%B9%E8%B1%A1%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98">对象级别的缓存</a></li></ul></li> <li>何时更新缓存
<ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98%E6%A8%A1%E5%BC%8F">缓存模式</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%9B%B4%E5%86%99%E6%A8%A1%E5%BC%8F">直写模式</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%9E%E5%86%99%E6%A8%A1%E5%BC%8F">回写模式</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%B7%E6%96%B0">刷新</a></li></ul></li></ul> <h3 id="-17"><span id="-17" class="anchor"></span>异步与微服务<a href="#-17" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97">消息队列</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97">任务队列</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%83%8C%E5%8E%8B">背压</a></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BE%AE%E6%9C%8D%E5%8A%A1">微服务</a></li></ul> <h3 id="-18"><span id="-18" class="anchor"></span>通信<a href="#-18" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>可权衡选择的方案：
<ul><li>与客户端的外部通信 - <a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%A1%A8%E8%BF%B0%E6%80%A7%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BBrest">使用 REST 作为 HTTP API</a></li> <li>服务器内部通信 - <a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AErpc">RPC</a></li></ul></li> <li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0">服务发现</a></li></ul> <h3 id="-19"><span id="-19" class="anchor"></span>安全性<a href="#-19" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>请参阅<a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%89%E5%85%A8">「安全」</a>一章。</p> <h3 id="-20"><span id="-20" class="anchor"></span>延迟数值<a href="#-20" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <p>请参阅<a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%AF%8F%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%91%98%E9%83%BD%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%95%B0">「每个程序员都应该知道的延迟数」</a>。</p> <h3 id="-21"><span id="-21" class="anchor"></span>持续探讨<a href="#-21" onclick="event.stopPropagation()" class="fa fa-anchor"></a></h3> <ul><li>持续进行基准测试并监控你的系统，以解决他们提出的瓶颈问题。</li> <li>架构拓展是一个迭代的过程。</li></ul> <i id="scroll-top-button" onclick="handleScrollTop()" aria-hidden="true" class="fa fa-arrow-circle-up fa-lg d-print-none"></i></div> <nav id="page-nav" class="fixed-header-padding" data-v-e8c82f88><div class="nav-component slim-scroll" data-v-e8c82f88></div> <!----></nav></div> <footer><div class="text-center"><small>[Generated by <a href="https://markbind.org/">MarkBind 3.1.1</a>]</small></div></footer></div>
</body><script src="../../../markbind/js/bootstrap-utility.min.js"></script>
<script>
  MarkBind.setupWithSearch()
</script>
</html>
