
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"fixed":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"brand",fn:function(){return [_c('a',{staticClass:"navbar-brand",attrs:{"href":"https://mazx4960.github.io/system-design-primer//index.html","title":"Home"}},[_v("System Design Primer")])]},proxy:true},{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_v(" "),_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Solutions")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/mint/readme.html"}},[_v("mint")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/pastebin/readme.html"}},[_v("pastebin")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/query_cache/readme.html"}},[_v("query_cache")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/sales_rank/readme.html"}},[_v("sales_rank")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/scaling_aws/readme.html"}},[_v("scaling_aws")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/social_graph/readme.html"}},[_v("social_graph")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/twitter/readme.html"}},[_v("twitter")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/web_crawler/readme.html"}},[_v("web_crawler")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"font-weight-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Topics")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Preface\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Motivation.html"}},[_v("Motivation")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Ankiflashcards.html"}},[_v("Anki flashcards")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Indexof-system-design-topics.html"}},[_v("Index")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Studyguide.html"}},[_v("Study Guide")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Interview Questions\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Howto-approach-a-system-design-interview-question.html"}},[_v("How to approach a system design interview question")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Object-orienteddesign-interview-questions-with-solutions.html"}},[_v("OOP interview questions")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-interview-questions-with-solutions.html"}},[_v("System design interview questions")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-topics-start-here.html"}},[_v("System design topics")]),_v(" "),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Performancevs-scalability.html"}},[_v("Performance vs scalability")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Latencyvs-throughput.html"}},[_v("Latency vs throughput")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilityvs-consistency.html"}},[_v("Availability vs consistency")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Consistencypatterns.html"}},[_v("Consistency patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilitypatterns.html"}},[_v("Availability patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Domainname-system.html"}},[_v("Domain name system")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contentdelivery-network.html"}},[_v("Content delivery network")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Loadbalancer.html"}},[_v("Load balancer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Reverseproxy-(web-server).html"}},[_v("Reverse proxy (web server)")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Applicationlayer.html"}},[_v("Application layer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Database.html"}},[_v("Database")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Cache.html"}},[_v("Cache")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Asynchronism.html"}},[_v("Asynchronism")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Communication.html"}},[_v("Communication")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Security.html"}},[_v("Security")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Misc\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Appendix.html"}},[_v("Appendix")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Underdevelopment.html"}},[_v("Under development")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Credits.html"}},[_v("Credits")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contactinfo.html"}},[_v("Contact info")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contributing.html"}},[_v("Contributing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/License.html"}},[_v("License")])])])])])])],1)],1)]),_v(" "),_m(0),_v(" "),_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"},[_c('a',{pre:true,attrs:{"class":"navbar-brand page-nav-title","href":"#"}},[_v("Chapters of This Page")]),_v(" "),_c('overlay-source',{staticClass:"nav nav-pills flex-column my-0 small no-flex-wrap",attrs:{"id":"mb-page-nav","tag-name":"nav","to":"mb-page-nav"}},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#design-a-key-value-cache-to-save-the-results-of-the-most-recent-web-server-queries"}},[_v("Design a key-value cache to save the results of the most recent web server queries‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-1-outline-use-cases-and-constraints"}},[_v("Step 1: Outline use cases and constraints‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#use-cases"}},[_v("Use cases‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#constraints-and-assumptions"}},[_v("Constraints and assumptions‎")])]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-2-create-a-high-level-design"}},[_v("Step 2: Create a high level design‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-3-design-core-components"}},[_v("Step 3: Design core components‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#use-case-user-sends-a-request-resulting-in-a-cache-hit"}},[_v("Use case: User sends a request resulting in a cache hit‎")])]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-4-scale-the-design"}},[_v("Step 4: Scale the design‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#expanding-the-memory-cache-to-many-machines"}},[_v("Expanding the Memory Cache to many machines‎")])]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#additional-talking-points"}},[_v("Additional talking points‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#sql-scaling-patterns"}},[_v("SQL scaling patterns‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#caching"}},[_v("Caching‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#asynchronism-and-microservices"}},[_v("Asynchronism and microservices‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#communications"}},[_v("Communications‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#security"}},[_v("Security‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#latency-numbers"}},[_v("Latency numbers‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#ongoing"}},[_v("Ongoing‎")])])])])],1)])],1),_v(" "),_m(1)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('div',{staticClass:"fixed-header-padding",attrs:{"id":"content-wrapper"}},[_c('br'),_v(" "),_c('br'),_v(" "),_c('br'),_v(" "),_c('h1',{attrs:{"id":"design-a-key-value-cache-to-save-the-results-of-the-most-recent-web-server-queries"}},[_c('span',{staticClass:"anchor",attrs:{"id":"design-a-key-value-cache-to-save-the-results-of-the-most-recent-web-server-queries"}}),_v("Design a key-value cache to save the results of the most recent web server queries"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#design-a-key-value-cache-to-save-the-results-of-the-most-recent-web-server-queries","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('em',[_v("Note: This document links directly to relevant areas found in the "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#index-of-system-design-topics"}},[_v("system design topics")]),_v(" to avoid duplication.  Refer to the linked content for general talking points, tradeoffs, and alternatives.")])]),_v(" "),_c('h2',{attrs:{"id":"step-1-outline-use-cases-and-constraints"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-1-outline-use-cases-and-constraints"}}),_v("Step 1: Outline use cases and constraints"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-1-outline-use-cases-and-constraints","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Gather requirements and scope the problem.\nAsk questions to clarify use cases and constraints.\nDiscuss assumptions.")])]),_v(" "),_c('p',[_v("Without an interviewer to address clarifying questions, we'll define some use cases and constraints.")]),_v(" "),_c('h3',{attrs:{"id":"use-cases"}},[_c('span',{staticClass:"anchor",attrs:{"id":"use-cases"}}),_v("Use cases"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#use-cases","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"we-ll-scope-the-problem-to-handle-only-the-following-use-cases"}},[_c('span',{staticClass:"anchor",attrs:{"id":"we-ll-scope-the-problem-to-handle-only-the-following-use-cases"}}),_v("We'll scope the problem to handle only the following use cases"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#we-ll-scope-the-problem-to-handle-only-the-following-use-cases","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("User")]),_v(" sends a search request resulting in a cache hit")]),_v(" "),_c('li',[_c('strong',[_v("User")]),_v(" sends a search request resulting in a cache miss")]),_v(" "),_c('li',[_c('strong',[_v("Service")]),_v(" has high availability")])]),_v(" "),_c('h3',{attrs:{"id":"constraints-and-assumptions"}},[_c('span',{staticClass:"anchor",attrs:{"id":"constraints-and-assumptions"}}),_v("Constraints and assumptions"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#constraints-and-assumptions","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"state-assumptions"}},[_c('span',{staticClass:"anchor",attrs:{"id":"state-assumptions"}}),_v("State assumptions"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#state-assumptions","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Traffic is not evenly distributed\n"),_c('ul',[_c('li',[_v("Popular queries should almost always be in the cache")]),_v(" "),_c('li',[_v("Need to determine how to expire/refresh")])])]),_v(" "),_c('li',[_v("Serving from cache requires fast lookups")]),_v(" "),_c('li',[_v("Low latency between machines")]),_v(" "),_c('li',[_v("Limited memory in cache\n"),_c('ul',[_c('li',[_v("Need to determine what to keep/remove")]),_v(" "),_c('li',[_v("Need to cache millions of queries")])])]),_v(" "),_c('li',[_v("10 million users")]),_v(" "),_c('li',[_v("10 billion queries per month")])]),_v(" "),_c('h4',{attrs:{"id":"calculate-usage"}},[_c('span',{staticClass:"anchor",attrs:{"id":"calculate-usage"}}),_v("Calculate usage"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#calculate-usage","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("Clarify with your interviewer if you should run back-of-the-envelope usage calculations.")])]),_v(" "),_c('ul',[_c('li',[_v("Cache stores ordered list of key: query, value: results\n"),_c('ul',[_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("query")]),_v(" - 50 bytes")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("title")]),_v(" - 20 bytes")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("snippet")]),_v(" - 200 bytes")]),_v(" "),_c('li',[_v("Total: 270 bytes")])])]),_v(" "),_c('li',[_v("2.7 TB of cache data per month if all 10 billion queries are unique and all are stored\n"),_c('ul',[_c('li',[_v("270 bytes per search * 10 billion searches per month")]),_v(" "),_c('li',[_v("Assumptions state limited memory, need to determine how to expire contents")])])]),_v(" "),_c('li',[_v("4,000 requests per second")])]),_v(" "),_c('p',[_v("Handy conversion guide:")]),_v(" "),_c('ul',[_c('li',[_v("2.5 million seconds per month")]),_v(" "),_c('li',[_v("1 request per second = 2.5 million requests per month")]),_v(" "),_c('li',[_v("40 requests per second = 100 million requests per month")]),_v(" "),_c('li',[_v("400 requests per second = 1 billion requests per month")])]),_v(" "),_c('h2',{attrs:{"id":"step-2-create-a-high-level-design"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-2-create-a-high-level-design"}}),_v("Step 2: Create a high level design"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-2-create-a-high-level-design","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Outline a high level design with all important components.")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/KqZ3dSx.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/KqZ3dSx.png","alt":""}})])]),_v(" "),_c('h2',{attrs:{"id":"step-3-design-core-components"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-3-design-core-components"}}),_v("Step 3: Design core components"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-3-design-core-components","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Dive into details for each core component.")])]),_v(" "),_c('h3',{attrs:{"id":"use-case-user-sends-a-request-resulting-in-a-cache-hit"}},[_c('span',{staticClass:"anchor",attrs:{"id":"use-case-user-sends-a-request-resulting-in-a-cache-hit"}}),_v("Use case: User sends a request resulting in a cache hit"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#use-case-user-sends-a-request-resulting-in-a-cache-hit","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("Popular queries can be served from a "),_c('strong',[_v("Memory Cache")]),_v(" such as Redis or Memcached to reduce read latency and to avoid overloading the "),_c('strong',[_v("Reverse Index Service")]),_v(" and "),_c('strong',[_v("Document Service")]),_v(".  Reading 1 MB sequentially from memory takes about 250 microseconds, while reading from SSD takes 4x and from disk takes 80x longer."),_c('sup',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("1")])])]),_v(" "),_c('p',[_v("Since the cache has limited capacity, we'll use a least recently used (LRU) approach to expire older entries.")]),_v(" "),_c('ul',[_c('li',[_v("The "),_c('strong',[_v("Client")]),_v(" sends a request to the "),_c('strong',[_v("Web Server")]),_v(", running as a "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server"}},[_v("reverse proxy")])]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("Web Server")]),_v(" forwards the request to the "),_c('strong',[_v("Query API")]),_v(" server")]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("Query API")]),_v(" server does the following:\n"),_c('ul',[_c('li',[_v("Parses the query\n"),_c('ul',[_c('li',[_v("Removes markup")]),_v(" "),_c('li',[_v("Breaks up the text into terms")]),_v(" "),_c('li',[_v("Fixes typos")]),_v(" "),_c('li',[_v("Normalizes capitalization")]),_v(" "),_c('li',[_v("Converts the query to use boolean operations")])])]),_v(" "),_c('li',[_v("Checks the "),_c('strong',[_v("Memory Cache")]),_v(" for the content matching the query\n"),_c('ul',[_c('li',[_v("If there's a hit in the "),_c('strong',[_v("Memory Cache")]),_v(", the "),_c('strong',[_v("Memory Cache")]),_v(" does the following:\n"),_c('ul',[_c('li',[_v("Updates the cached entry's position to the front of the LRU list")]),_v(" "),_c('li',[_v("Returns the cached contents")])])]),_v(" "),_c('li',[_v("Else, the "),_c('strong',[_v("Query API")]),_v(" does the following:\n"),_c('ul',[_c('li',[_v("Uses the "),_c('strong',[_v("Reverse Index Service")]),_v(" to find documents matching the query\n"),_c('ul',[_c('li',[_v("The "),_c('strong',[_v("Reverse Index Service")]),_v(" ranks the matching results and returns the top ones")])])]),_v(" "),_c('li',[_v("Uses the "),_c('strong',[_v("Document Service")]),_v(" to return titles and snippets")]),_v(" "),_c('li',[_v("Updates the "),_c('strong',[_v("Memory Cache")]),_v(" with the contents, placing the entry at the front of the LRU list")])])])])])])])]),_v(" "),_c('h4',{attrs:{"id":"cache-implementation"}},[_c('span',{staticClass:"anchor",attrs:{"id":"cache-implementation"}}),_v("Cache implementation"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#cache-implementation","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("The cache can use a doubly-linked list: new items will be added to the head while items to expire will be removed from the tail.  We'll use a hash table for fast lookups to each linked list node.")]),_v(" "),_c('p',[_c('strong',[_v("Clarify with your interviewer how much code you are expected to write")]),_v(".")]),_v(" "),_c('p',[_c('strong',[_v("Query API Server")]),_v(" implementation:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("QueryApi")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, memory_cache, reverse_index_service")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.memory_cache = memory_cache\n")]),_c('span',[_v("        self.reverse_index_service = reverse_index_service\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("parse_query")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, query")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Remove markup, break text into terms, deal with typos,")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        normalize capitalization, convert to use boolean operations.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("process_query")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, query")]),_v("):")]),_v("\n")]),_c('span',[_v("        query = self.parse_query(query)\n")]),_c('span',[_v("        results = self.memory_cache.get(query)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" results "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("is")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v(":\n")]),_c('span',[_v("            results = self.reverse_index_service.process_search(query)\n")]),_c('span',[_v("            self.memory_cache."),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("set")]),_v("(query, results)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" results\n")])])]),_c('p',[_c('strong',[_v("Node")]),_v(" implementation:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Node")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, query, results")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.query = query\n")]),_c('span',[_v("        self.results = results\n")])])]),_c('p',[_c('strong',[_v("LinkedList")]),_v(" implementation:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("LinkedList")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.head = "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v("\n")]),_c('span',[_v("        self.tail = "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("move_to_front")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, node")]),_v("):")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("append_to_front")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, node")]),_v("):")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("remove_from_tail")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self")]),_v("):")]),_v("\n")]),_c('span',[_v("        ...\n")])])]),_c('p',[_c('strong',[_v("Cache")]),_v(" implementation:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Cache")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, MAX_SIZE")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.MAX_SIZE = MAX_SIZE\n")]),_c('span',[_v("        self.size = "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("0")]),_v("\n")]),_c('span',[_v("        self.lookup = {}  "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("# key: query, value: node")]),_v("\n")]),_c('span',[_v("        self.linked_list = LinkedList()\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("get")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, query")]),_v(")")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        \"\"\""),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Get")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("the")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("stored")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("query")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("result")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("the")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("cache")]),_v(".")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Accessing")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("a")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("node")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("updates")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("its")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("position")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("to")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("the")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("front")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("of")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("the")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("LRU")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("list")]),_v(".")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("node")]),_v(" = "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("self")]),_v("."),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("lookup")]),_v("["),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("query")]),_v("]")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("if")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("node")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("is")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("None")]),_v(":")]),_v("\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v("\n")]),_c('span',[_v("        self.linked_list.move_to_front(node)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" node.results\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("set")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, results, query")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Set the result for the given query key in the cache.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        When updating an entry, updates its position to the front of the LRU list.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        If the entry is new and the cache is at capacity, removes the oldest entry")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        before the new entry is added.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        node = self.lookup[query]\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" node "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("is")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("not")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v(":\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("# Key exists in cache, update the value")]),_v("\n")]),_c('span',[_v("            node.results = results\n")]),_c('span',[_v("            self.linked_list.move_to_front(node)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("else")]),_v(":\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("# Key does not exist in cache")]),_v("\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" self.size == self.MAX_SIZE:\n")]),_c('span',[_v("                "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("# Remove the oldest entry from the linked list and lookup")]),_v("\n")]),_c('span',[_v("                self.lookup.pop(self.linked_list.tail.query, "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v(")\n")]),_c('span',[_v("                self.linked_list.remove_from_tail()\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("else")]),_v(":\n")]),_c('span',[_v("                self.size += "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v("\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("# Add the new key and value")]),_v("\n")]),_c('span',[_v("            new_node = Node(query, results)\n")]),_c('span',[_v("            self.linked_list.append_to_front(new_node)\n")]),_c('span',[_v("            self.lookup[query] = new_node\n")])])]),_c('h4',{attrs:{"id":"when-to-update-the-cache"}},[_c('span',{staticClass:"anchor",attrs:{"id":"when-to-update-the-cache"}}),_v("When to update the cache"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#when-to-update-the-cache","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("The cache should be updated when:")]),_v(" "),_c('ul',[_c('li',[_v("The page contents change")]),_v(" "),_c('li',[_v("The page is removed or a new page is added")]),_v(" "),_c('li',[_v("The page rank changes")])]),_v(" "),_c('p',[_v("The most straightforward way to handle these cases is to simply set a max time that a cached entry can stay in the cache before it is updated, usually referred to as time to live (TTL).")]),_v(" "),_c('p',[_v("Refer to "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#when-to-update-the-cache"}},[_v("When to update the cache")]),_v(" for tradeoffs and alternatives.  The approach above describes "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache-aside"}},[_v("cache-aside")]),_v(".")]),_v(" "),_c('h2',{attrs:{"id":"step-4-scale-the-design"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-4-scale-the-design"}}),_v("Step 4: Scale the design"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-4-scale-the-design","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Identify and address bottlenecks, given the constraints.")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/4j99mhe.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/4j99mhe.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("Important: Do not simply jump right into the final design from the initial design!")])]),_v(" "),_c('p',[_v("State you would 1) "),_c('strong',[_v("Benchmark/Load Test")]),_v(", 2) "),_c('strong',[_v("Profile")]),_v(" for bottlenecks 3) address bottlenecks while evaluating alternatives and trade-offs, and 4) repeat.  See "),_c('a',{attrs:{"href":"/mazx4960.github.io/system-design-primer/solutions/system_design/scaling_aws/README.html"}},[_v("Design a system that scales to millions of users on AWS")]),_v(" as a sample on how to iteratively scale the initial design.")]),_v(" "),_c('p',[_v("It's important to discuss what bottlenecks you might encounter with the initial design and how you might address each of them.  For example, what issues are addressed by adding a "),_c('strong',[_v("Load Balancer")]),_v(" with multiple "),_c('strong',[_v("Web Servers")]),_v("?  "),_c('strong',[_v("CDN")]),_v("?  "),_c('strong',[_v("Master-Slave Replicas")]),_v("?  What are the alternatives and "),_c('strong',[_v("Trade-Offs")]),_v(" for each?")]),_v(" "),_c('p',[_v("We'll introduce some components to complete the design and to address scalability issues.  Internal load balancers are not shown to reduce clutter.")]),_v(" "),_c('p',[_c('em',[_v("To avoid repeating discussions")]),_v(", refer to the following "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#index-of-system-design-topics"}},[_v("system design topics")]),_v(" for main talking points, tradeoffs, and alternatives:")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#domain-name-system"}},[_v("DNS")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#load-balancer"}},[_v("Load balancer")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#horizontal-scaling"}},[_v("Horizontal scaling")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server"}},[_v("Web server (reverse proxy)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-layer"}},[_v("API server (application layer)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache"}},[_v("Cache")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#consistency-patterns"}},[_v("Consistency patterns")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#availability-patterns"}},[_v("Availability patterns")])])]),_v(" "),_c('h3',{attrs:{"id":"expanding-the-memory-cache-to-many-machines"}},[_c('span',{staticClass:"anchor",attrs:{"id":"expanding-the-memory-cache-to-many-machines"}}),_v("Expanding the Memory Cache to many machines"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#expanding-the-memory-cache-to-many-machines","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("To handle the heavy request load and the large amount of memory needed, we'll scale horizontally.  We have three main options on how to store the data on our "),_c('strong',[_v("Memory Cache")]),_v(" cluster:")]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("Each machine in the cache cluster has its own cache")]),_v(" - Simple, although it will likely result in a low cache hit rate.")]),_v(" "),_c('li',[_c('strong',[_v("Each machine in the cache cluster has a copy of the cache")]),_v(" - Simple, although it is an inefficient use of memory.")]),_v(" "),_c('li',[_c('strong',[_v("The cache is "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sharding"}},[_v("sharded")]),_v(" across all machines in the cache cluster")]),_v(" - More complex, although it is likely the best option.  We could use hashing to determine which machine could have the cached results of a query using "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("machine = hash(query)")]),_v(".  We'll likely want to use "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#under-development"}},[_v("consistent hashing")]),_v(".")])]),_v(" "),_c('h2',{attrs:{"id":"additional-talking-points"}},[_c('span',{staticClass:"anchor",attrs:{"id":"additional-talking-points"}}),_v("Additional talking points"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#additional-talking-points","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Additional topics to dive into, depending on the problem scope and time remaining.")])]),_v(" "),_c('h3',{attrs:{"id":"sql-scaling-patterns"}},[_c('span',{staticClass:"anchor",attrs:{"id":"sql-scaling-patterns"}}),_v("SQL scaling patterns"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#sql-scaling-patterns","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#master-slave-replication"}},[_v("Read replicas")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#federation"}},[_v("Federation")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sharding"}},[_v("Sharding")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#denormalization"}},[_v("Denormalization")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-tuning"}},[_v("SQL Tuning")])])]),_v(" "),_c('h4',{attrs:{"id":"nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nosql"}}),_v("NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#key-value-store"}},[_v("Key-value store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#document-store"}},[_v("Document store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#wide-column-store"}},[_v("Wide column store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#graph-database"}},[_v("Graph database")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-or-nosql"}},[_v("SQL vs NoSQL")])])]),_v(" "),_c('h3',{attrs:{"id":"caching"}},[_c('span',{staticClass:"anchor",attrs:{"id":"caching"}}),_v("Caching"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#caching","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Where to cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#client-caching"}},[_v("Client caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cdn-caching"}},[_v("CDN caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#web-server-caching"}},[_v("Web server caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#database-caching"}},[_v("Database caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-caching"}},[_v("Application caching")])])])]),_v(" "),_c('li',[_v("What to cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-database-query-level"}},[_v("Caching at the database query level")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-object-level"}},[_v("Caching at the object level")])])])]),_v(" "),_c('li',[_v("When to update the cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache-aside"}},[_v("Cache-aside")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-through"}},[_v("Write-through")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-behind-write-back"}},[_v("Write-behind (write-back)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#refresh-ahead"}},[_v("Refresh ahead")])])])])]),_v(" "),_c('h3',{attrs:{"id":"asynchronism-and-microservices"}},[_c('span',{staticClass:"anchor",attrs:{"id":"asynchronism-and-microservices"}}),_v("Asynchronism and microservices"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#asynchronism-and-microservices","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#message-queues"}},[_v("Message queues")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#task-queues"}},[_v("Task queues")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#back-pressure"}},[_v("Back pressure")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#microservices"}},[_v("Microservices")])])]),_v(" "),_c('h3',{attrs:{"id":"communications"}},[_c('span',{staticClass:"anchor",attrs:{"id":"communications"}}),_v("Communications"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#communications","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Discuss tradeoffs:\n"),_c('ul',[_c('li',[_v("External communication with clients - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest"}},[_v("HTTP APIs following REST")])]),_v(" "),_c('li',[_v("Internal communications - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc"}},[_v("RPC")])])])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#service-discovery"}},[_v("Service discovery")])])]),_v(" "),_c('h3',{attrs:{"id":"security"}},[_c('span',{staticClass:"anchor",attrs:{"id":"security"}}),_v("Security"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#security","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("Refer to the "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#security"}},[_v("security section")]),_v(".")]),_v(" "),_c('h3',{attrs:{"id":"latency-numbers"}},[_c('span',{staticClass:"anchor",attrs:{"id":"latency-numbers"}}),_v("Latency numbers"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#latency-numbers","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("See "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("Latency numbers every programmer should know")]),_v(".")]),_v(" "),_c('h3',{attrs:{"id":"ongoing"}},[_c('span',{staticClass:"anchor",attrs:{"id":"ongoing"}}),_v("Ongoing"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#ongoing","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Continue benchmarking and monitoring your system to address bottlenecks as they come up")]),_v(" "),_c('li',[_v("Scaling is an iterative process")])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 3.1.1")]),_v("]")])])])}
}];
  