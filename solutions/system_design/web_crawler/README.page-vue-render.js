
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"fixed":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"brand",fn:function(){return [_c('a',{staticClass:"navbar-brand",attrs:{"href":"/index.html","title":"Home"}},[_v("System Design Primer")])]},proxy:true},{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_v(" "),_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Solutions")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/mint/readme.html"}},[_v("mint")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/pastebin/readme.html"}},[_v("pastebin")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/query_cache/readme.html"}},[_v("query_cache")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/sales_rank/readme.html"}},[_v("sales_rank")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/scaling_aws/readme.html"}},[_v("scaling_aws")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/social_graph/readme.html"}},[_v("social_graph")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/twitter/readme.html"}},[_v("twitter")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/solutions/system_design/web_crawler/readme.html"}},[_v("web_crawler")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"font-weight-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Topics")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Preface\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Motivation.html"}},[_v("Motivation")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Ankiflashcards.html"}},[_v("Anki flashcards")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Indexof-system-design-topics.html"}},[_v("Index")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Studyguide.html"}},[_v("Study Guide")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Interview Questions\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Howto-approach-a-system-design-interview-question.html"}},[_v("How to approach a system design interview question")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Object-orienteddesign-interview-questions-with-solutions.html"}},[_v("OOP interview questions")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Systemdesign-interview-questions-with-solutions.html"}},[_v("System design interview questions")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Systemdesign-topics-start-here.html"}},[_v("System design topics")]),_v(" "),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Performancevs-scalability.html"}},[_v("Performance vs scalability")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Latencyvs-throughput.html"}},[_v("Latency vs throughput")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Availabilityvs-consistency.html"}},[_v("Availability vs consistency")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Consistencypatterns.html"}},[_v("Consistency patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Availabilitypatterns.html"}},[_v("Availability patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Domainname-system.html"}},[_v("Domain name system")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contentdelivery-network.html"}},[_v("Content delivery network")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Loadbalancer.html"}},[_v("Load balancer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Reverseproxy-(web-server).html"}},[_v("Reverse proxy (web server)")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Applicationlayer.html"}},[_v("Application layer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Database.html"}},[_v("Database")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Cache.html"}},[_v("Cache")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Asynchronism.html"}},[_v("Asynchronism")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Communication.html"}},[_v("Communication")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Security.html"}},[_v("Security")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Misc\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Appendix.html"}},[_v("Appendix")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Underdevelopment.html"}},[_v("Under development")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Credits.html"}},[_v("Credits")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contactinfo.html"}},[_v("Contact info")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/Contributing.html"}},[_v("Contributing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/contents/License.html"}},[_v("License")])])])])])])],1)],1)]),_v(" "),_m(0),_v(" "),_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"},[_c('a',{pre:true,attrs:{"class":"navbar-brand page-nav-title","href":"#"}},[_v("Chapters of This Page")]),_v(" "),_c('overlay-source',{staticClass:"nav nav-pills flex-column my-0 small no-flex-wrap",attrs:{"id":"mb-page-nav","tag-name":"nav","to":"mb-page-nav"}},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#design-a-web-crawler"}},[_v("Design a web crawler‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-1-outline-use-cases-and-constraints"}},[_v("Step 1: Outline use cases and constraints‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#use-cases"}},[_v("Use cases‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#constraints-and-assumptions"}},[_v("Constraints and assumptions‎")])]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-2-create-a-high-level-design"}},[_v("Step 2: Create a high level design‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-3-design-core-components"}},[_v("Step 3: Design core components‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#use-case-service-crawls-a-list-of-urls"}},[_v("Use case: Service crawls a list of urls‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#handling-duplicates"}},[_v("Handling duplicates‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#determining-when-to-update-the-crawl-results"}},[_v("Determining when to update the crawl results‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#use-case-user-inputs-a-search-term-and-sees-a-list-of-relevant-pages-with-titles-and-snippets"}},[_v("Use case: User inputs a search term and sees a list of relevant pages with titles and snippets‎")])]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#step-4-scale-the-design"}},[_v("Step 4: Scale the design‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#additional-talking-points"}},[_v("Additional talking points‎")]),_v(" "),_c('nav',{staticClass:"nav nav-pills flex-column my-0 nested no-flex-wrap"},[_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#sql-scaling-patterns"}},[_v("SQL scaling patterns‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#caching"}},[_v("Caching‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#asynchronism-and-microservices"}},[_v("Asynchronism and microservices‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#communications"}},[_v("Communications‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#security"}},[_v("Security‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#latency-numbers"}},[_v("Latency numbers‎")]),_v(" "),_c('a',{pre:true,attrs:{"class":"nav-link py-1","href":"#ongoing"}},[_v("Ongoing‎")])])])])],1)])],1),_v(" "),_m(1)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('div',{staticClass:"fixed-header-padding",attrs:{"id":"content-wrapper"}},[_c('br'),_v(" "),_c('br'),_v(" "),_c('br'),_v(" "),_c('h1',{attrs:{"id":"design-a-web-crawler"}},[_c('span',{staticClass:"anchor",attrs:{"id":"design-a-web-crawler"}}),_v("Design a web crawler"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#design-a-web-crawler","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('em',[_v("Note: This document links directly to relevant areas found in the "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#index-of-system-design-topics"}},[_v("system design topics")]),_v(" to avoid duplication.  Refer to the linked content for general talking points, tradeoffs, and alternatives.")])]),_v(" "),_c('h2',{attrs:{"id":"step-1-outline-use-cases-and-constraints"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-1-outline-use-cases-and-constraints"}}),_v("Step 1: Outline use cases and constraints"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-1-outline-use-cases-and-constraints","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Gather requirements and scope the problem.\nAsk questions to clarify use cases and constraints.\nDiscuss assumptions.")])]),_v(" "),_c('p',[_v("Without an interviewer to address clarifying questions, we'll define some use cases and constraints.")]),_v(" "),_c('h3',{attrs:{"id":"use-cases"}},[_c('span',{staticClass:"anchor",attrs:{"id":"use-cases"}}),_v("Use cases"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#use-cases","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"we-ll-scope-the-problem-to-handle-only-the-following-use-cases"}},[_c('span',{staticClass:"anchor",attrs:{"id":"we-ll-scope-the-problem-to-handle-only-the-following-use-cases"}}),_v("We'll scope the problem to handle only the following use cases"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#we-ll-scope-the-problem-to-handle-only-the-following-use-cases","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("Service")]),_v(" crawls a list of urls:\n"),_c('ul',[_c('li',[_v("Generates reverse index of words to pages containing the search terms")]),_v(" "),_c('li',[_v("Generates titles and snippets for pages\n"),_c('ul',[_c('li',[_v("Title and snippets are static, they do not change based on search query")])])])])]),_v(" "),_c('li',[_c('strong',[_v("User")]),_v(" inputs a search term and sees a list of relevant pages with titles and snippets  the crawler generated\n"),_c('ul',[_c('li',[_v("Only sketch high level components and interactions for this use case, no need to go into depth")])])]),_v(" "),_c('li',[_c('strong',[_v("Service")]),_v(" has high availability")])]),_v(" "),_c('h4',{attrs:{"id":"out-of-scope"}},[_c('span',{staticClass:"anchor",attrs:{"id":"out-of-scope"}}),_v("Out of scope"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#out-of-scope","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Search analytics")]),_v(" "),_c('li',[_v("Personalized search results")]),_v(" "),_c('li',[_v("Page rank")])]),_v(" "),_c('h3',{attrs:{"id":"constraints-and-assumptions"}},[_c('span',{staticClass:"anchor",attrs:{"id":"constraints-and-assumptions"}}),_v("Constraints and assumptions"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#constraints-and-assumptions","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"state-assumptions"}},[_c('span',{staticClass:"anchor",attrs:{"id":"state-assumptions"}}),_v("State assumptions"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#state-assumptions","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Traffic is not evenly distributed\n"),_c('ul',[_c('li',[_v("Some searches are very popular, while others are only executed once")])])]),_v(" "),_c('li',[_v("Support only anonymous users")]),_v(" "),_c('li',[_v("Generating search results should be fast")]),_v(" "),_c('li',[_v("The web crawler should not get stuck in an infinite loop\n"),_c('ul',[_c('li',[_v("We get stuck in an infinite loop if the graph contains a cycle")])])]),_v(" "),_c('li',[_v("1 billion links to crawl\n"),_c('ul',[_c('li',[_v("Pages need to be crawled regularly to ensure freshness")]),_v(" "),_c('li',[_v("Average refresh rate of about once per week, more frequent for popular sites\n"),_c('ul',[_c('li',[_v("4 billion links crawled each month")])])]),_v(" "),_c('li',[_v("Average stored size per web page: 500 KB\n"),_c('ul',[_c('li',[_v("For simplicity, count changes the same as new pages")])])])])]),_v(" "),_c('li',[_v("100 billion searches per month")])]),_v(" "),_c('p',[_v("Exercise the use of more traditional systems - don't use existing systems such as "),_c('a',{attrs:{"href":"http://lucene.apache.org/solr/"}},[_v("solr")]),_v(" or "),_c('a',{attrs:{"href":"http://nutch.apache.org/"}},[_v("nutch")]),_v(".")]),_v(" "),_c('h4',{attrs:{"id":"calculate-usage"}},[_c('span',{staticClass:"anchor",attrs:{"id":"calculate-usage"}}),_v("Calculate usage"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#calculate-usage","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("Clarify with your interviewer if you should run back-of-the-envelope usage calculations.")])]),_v(" "),_c('ul',[_c('li',[_v("2 PB of stored page content per month\n"),_c('ul',[_c('li',[_v("500 KB per page * 4 billion links crawled per month")]),_v(" "),_c('li',[_v("72 PB of stored page content in 3 years")])])]),_v(" "),_c('li',[_v("1,600 write requests per second")]),_v(" "),_c('li',[_v("40,000 search requests per second")])]),_v(" "),_c('p',[_v("Handy conversion guide:")]),_v(" "),_c('ul',[_c('li',[_v("2.5 million seconds per month")]),_v(" "),_c('li',[_v("1 request per second = 2.5 million requests per month")]),_v(" "),_c('li',[_v("40 requests per second = 100 million requests per month")]),_v(" "),_c('li',[_v("400 requests per second = 1 billion requests per month")])]),_v(" "),_c('h2',{attrs:{"id":"step-2-create-a-high-level-design"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-2-create-a-high-level-design"}}),_v("Step 2: Create a high level design"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-2-create-a-high-level-design","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Outline a high level design with all important components.")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/xjdAAUv.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/xjdAAUv.png","alt":""}})])]),_v(" "),_c('h2',{attrs:{"id":"step-3-design-core-components"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-3-design-core-components"}}),_v("Step 3: Design core components"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-3-design-core-components","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Dive into details for each core component.")])]),_v(" "),_c('h3',{attrs:{"id":"use-case-service-crawls-a-list-of-urls"}},[_c('span',{staticClass:"anchor",attrs:{"id":"use-case-service-crawls-a-list-of-urls"}}),_v("Use case: Service crawls a list of urls"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#use-case-service-crawls-a-list-of-urls","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("We'll assume we have an initial list of "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("links_to_crawl")]),_v(" ranked initially based on overall site popularity.  If this is not a reasonable assumption, we can seed the crawler with popular sites that link to outside content such as "),_c('a',{attrs:{"href":"https://www.yahoo.com/"}},[_v("Yahoo")]),_v(", "),_c('a',{attrs:{"href":"http://www.dmoz.org/"}},[_v("DMOZ")]),_v(", etc.")]),_v(" "),_c('p',[_v("We'll use a table "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("crawled_links")]),_v(" to store processed links and their page signatures.")]),_v(" "),_c('p',[_v("We could store "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("links_to_crawl")]),_v(" and "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("crawled_links")]),_v(" in a key-value "),_c('strong',[_v("NoSQL Database")]),_v(".  For the ranked links in "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("links_to_crawl")]),_v(", we could use "),_c('a',{attrs:{"href":"https://redis.io/"}},[_v("Redis")]),_v(" with sorted sets to maintain a ranking of page links.  We should discuss the "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-or-nosql"}},[_v("use cases and tradeoffs between choosing SQL or NoSQL")]),_v(".")]),_v(" "),_c('ul',[_c('li',[_v("The "),_c('strong',[_v("Crawler Service")]),_v(" processes each page link by doing the following in a loop:\n"),_c('ul',[_c('li',[_v("Takes the top ranked page link to crawl\n"),_c('ul',[_c('li',[_v("Checks "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("crawled_links")]),_v(" in the "),_c('strong',[_v("NoSQL Database")]),_v(" for an entry with a similar page signature\n"),_c('ul',[_c('li',[_v("If we have a similar page, reduces the priority of the page link\n"),_c('ul',[_c('li',[_v("This prevents us from getting into a cycle")]),_v(" "),_c('li',[_v("Continue")])])]),_v(" "),_c('li',[_v("Else, crawls the link\n"),_c('ul',[_c('li',[_v("Adds a job to the "),_c('strong',[_v("Reverse Index Service")]),_v(" queue to generate a "),_c('a',{attrs:{"href":"https://en.wikipedia.org/wiki/Search_engine_indexing"}},[_v("reverse index")])]),_v(" "),_c('li',[_v("Adds a job to the "),_c('strong',[_v("Document Service")]),_v(" queue to generate a static title and snippet")]),_v(" "),_c('li',[_v("Generates the page signature")]),_v(" "),_c('li',[_v("Removes the link from "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("links_to_crawl")]),_v(" in the "),_c('strong',[_v("NoSQL Database")])]),_v(" "),_c('li',[_v("Inserts the page link and signature to "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("crawled_links")]),_v(" in the "),_c('strong',[_v("NoSQL Database")])])])])])])])])])])]),_v(" "),_c('p',[_c('strong',[_v("Clarify with your interviewer how much code you are expected to write")]),_v(".")]),_v(" "),_c('p',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("PagesDataStore")]),_v(" is an abstraction within the "),_c('strong',[_v("Crawler Service")]),_v(" that uses the "),_c('strong',[_v("NoSQL Database")]),_v(":")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("PagesDataStore")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, db")]),_v(");")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("self")]),_v("."),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("db")]),_v(" = "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("db")])]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        ...")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("add_link_to_crawl")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, url")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Add the given link to `links_to_crawl`.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("remove_link_to_crawl")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, url")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Remove the given link from `links_to_crawl`.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("reduce_priority_link_to_crawl")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, url")]),_v(")")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        \"\"\""),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Reduce")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("the")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("priority")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("of")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("a")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("link")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("in")]),_v(" `"),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("links_to_crawl")]),_v("` "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("to")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("avoid")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("cycles")]),_v(".\"\"\"")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("        ...")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("extract_max_priority_page")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Return the highest priority link in `links_to_crawl`.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("insert_crawled_link")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, url, signature")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Add the given link to `crawled_links`.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("crawled_similar")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, signature")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Determine if we've already crawled a page matching the given signature\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")])])]),_c('p',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("Page")]),_v(" is an abstraction within the "),_c('strong',[_v("Crawler Service")]),_v(" that encapsulates a page, its contents, child urls, and signature:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Page")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, url, contents, child_urls, signature")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.url = url\n")]),_c('span',[_v("        self.contents = contents\n")]),_c('span',[_v("        self.child_urls = child_urls\n")]),_c('span',[_v("        self.signature = signature\n")])])]),_c('p',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("Crawler")]),_v(" is the main class within "),_c('strong',[_v("Crawler Service")]),_v(", composed of "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("Page")]),_v(" and "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("PagesDataStore")]),_v(".")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("Crawler")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("object")])]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("__init__")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, data_store, reverse_index_queue, doc_index_queue")]),_v("):")]),_v("\n")]),_c('span',[_v("        self.data_store = data_store\n")]),_c('span',[_v("        self.reverse_index_queue = reverse_index_queue\n")]),_c('span',[_v("        self.doc_index_queue = doc_index_queue\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("create_signature")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, page")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Create signature based on url and contents.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("crawl_page")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, page")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("for")]),_v(" url "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("in")]),_v(" page.child_urls:\n")]),_c('span',[_v("            self.data_store.add_link_to_crawl(url)\n")]),_c('span',[_v("        page.signature = self.create_signature(page)\n")]),_c('span',[_v("        self.data_store.remove_link_to_crawl(page.url)\n")]),_c('span',[_v("        self.data_store.insert_crawled_link(page.url, page.signature)\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("crawl")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("while")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("True")]),_v(":\n")]),_c('span',[_v("            page = self.data_store.extract_max_priority_page()\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" page "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("is")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-literal"}},[_v("None")]),_v(":\n")]),_c('span',[_v("                "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("break")]),_v("\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" self.data_store.crawled_similar(page.signature):\n")]),_c('span',[_v("                self.data_store.reduce_priority_link_to_crawl(page.url)\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("else")]),_v(":\n")]),_c('span',[_v("                self.crawl_page(page)\n")])])]),_c('h3',{attrs:{"id":"handling-duplicates"}},[_c('span',{staticClass:"anchor",attrs:{"id":"handling-duplicates"}}),_v("Handling duplicates"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#handling-duplicates","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("We need to be careful the web crawler doesn't get stuck in an infinite loop, which happens when the graph contains a cycle.")]),_v(" "),_c('p',[_c('strong',[_v("Clarify with your interviewer how much code you are expected to write")]),_v(".")]),_v(" "),_c('p',[_v("We'll want to remove duplicate urls:")]),_v(" "),_c('ul',[_c('li',[_v("For smaller lists we could use something like "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("sort | unique")])]),_v(" "),_c('li',[_v("With 1 billion links to crawl, we could use "),_c('strong',[_v("MapReduce")]),_v(" to output only entries that have a frequency of 1")])]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("RemoveDuplicateUrls")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("MRJob")]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("mapper")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, _, line")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" line, "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("reducer")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, key, values")]),_v("):")]),_v("\n")]),_c('span',[_v("        total = "),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("sum")]),_v("(values)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("if")]),_v(" total == "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v(":\n")]),_c('span',[_v("            "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" key, total\n")])])]),_c('p',[_v("Detecting duplicate content is more complex.  We could generate a signature based on the contents of the page and compare those two signatures for similarity.  Some potential algorithms are "),_c('a',{attrs:{"href":"https://en.wikipedia.org/wiki/Jaccard_index"}},[_v("Jaccard index")]),_v(" and "),_c('a',{attrs:{"href":"https://en.wikipedia.org/wiki/Cosine_similarity"}},[_v("cosine similarity")]),_v(".")]),_v(" "),_c('h3',{attrs:{"id":"determining-when-to-update-the-crawl-results"}},[_c('span',{staticClass:"anchor",attrs:{"id":"determining-when-to-update-the-crawl-results"}}),_v("Determining when to update the crawl results"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#determining-when-to-update-the-crawl-results","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("Pages need to be crawled regularly to ensure freshness.  Crawl results could have a "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("timestamp")]),_v(" field that indicates the last time a page was crawled.  After a default time period, say one week, all pages should be refreshed.  Frequently updated or more popular sites could be refreshed in shorter intervals.")]),_v(" "),_c('p',[_v("Although we won't dive into details on analytics, we could do some data mining to determine the mean time before a particular page is updated, and use that statistic to determine how often to re-crawl the page.")]),_v(" "),_c('p',[_v("We might also choose to support a "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("Robots.txt")]),_v(" file that gives webmasters control of crawl frequency.")]),_v(" "),_c('h3',{attrs:{"id":"use-case-user-inputs-a-search-term-and-sees-a-list-of-relevant-pages-with-titles-and-snippets"}},[_c('span',{staticClass:"anchor",attrs:{"id":"use-case-user-inputs-a-search-term-and-sees-a-list-of-relevant-pages-with-titles-and-snippets"}}),_v("Use case: User inputs a search term and sees a list of relevant pages with titles and snippets"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#use-case-user-inputs-a-search-term-and-sees-a-list-of-relevant-pages-with-titles-and-snippets","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("The "),_c('strong',[_v("Client")]),_v(" sends a request to the "),_c('strong',[_v("Web Server")]),_v(", running as a "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server"}},[_v("reverse proxy")])]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("Web Server")]),_v(" forwards the request to the "),_c('strong',[_v("Query API")]),_v(" server")]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("Query API")]),_v(" server does the following:\n"),_c('ul',[_c('li',[_v("Parses the query\n"),_c('ul',[_c('li',[_v("Removes markup")]),_v(" "),_c('li',[_v("Breaks up the text into terms")]),_v(" "),_c('li',[_v("Fixes typos")]),_v(" "),_c('li',[_v("Normalizes capitalization")]),_v(" "),_c('li',[_v("Converts the query to use boolean operations")])])]),_v(" "),_c('li',[_v("Uses the "),_c('strong',[_v("Reverse Index Service")]),_v(" to find documents matching the query\n"),_c('ul',[_c('li',[_v("The "),_c('strong',[_v("Reverse Index Service")]),_v(" ranks the matching results and returns the top ones")])])]),_v(" "),_c('li',[_v("Uses the "),_c('strong',[_v("Document Service")]),_v(" to return titles and snippets")])])])]),_v(" "),_c('p',[_v("We'll use a public "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest"}},[_c('strong',[_v("REST API")])]),_v(":")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("$ curl https://search.com/api/v1/search?query=hello+world\n")])])]),_c('p',[_v("Response:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("{\n")]),_c('span',[_v("    \"title\": \"foo's title\",\n")]),_c('span',[_v("    \"snippet\": \"foo's snippet\",\n")]),_c('span',[_v("    \"link\": \"https://foo.com\",\n")]),_c('span',[_v("},\n")]),_c('span',[_v("{\n")]),_c('span',[_v("    \"title\": \"bar's title\",\n")]),_c('span',[_v("    \"snippet\": \"bar's snippet\",\n")]),_c('span',[_v("    \"link\": \"https://bar.com\",\n")]),_c('span',[_v("},\n")]),_c('span',[_v("{\n")]),_c('span',[_v("    \"title\": \"baz's title\",\n")]),_c('span',[_v("    \"snippet\": \"baz's snippet\",\n")]),_c('span',[_v("    \"link\": \"https://baz.com\",\n")]),_c('span',[_v("},\n")])])]),_c('p',[_v("For internal communications, we could use "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc"}},[_v("Remote Procedure Calls")]),_v(".")]),_v(" "),_c('h2',{attrs:{"id":"step-4-scale-the-design"}},[_c('span',{staticClass:"anchor",attrs:{"id":"step-4-scale-the-design"}}),_v("Step 4: Scale the design"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#step-4-scale-the-design","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Identify and address bottlenecks, given the constraints.")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/bWxPtQA.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/bWxPtQA.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("Important: Do not simply jump right into the final design from the initial design!")])]),_v(" "),_c('p',[_v("State you would 1) "),_c('strong',[_v("Benchmark/Load Test")]),_v(", 2) "),_c('strong',[_v("Profile")]),_v(" for bottlenecks 3) address bottlenecks while evaluating alternatives and trade-offs, and 4) repeat.  See "),_c('a',{attrs:{"href":"/solutions/system_design/scaling_aws/README.html"}},[_v("Design a system that scales to millions of users on AWS")]),_v(" as a sample on how to iteratively scale the initial design.")]),_v(" "),_c('p',[_v("It's important to discuss what bottlenecks you might encounter with the initial design and how you might address each of them.  For example, what issues are addressed by adding a "),_c('strong',[_v("Load Balancer")]),_v(" with multiple "),_c('strong',[_v("Web Servers")]),_v("?  "),_c('strong',[_v("CDN")]),_v("?  "),_c('strong',[_v("Master-Slave Replicas")]),_v("?  What are the alternatives and "),_c('strong',[_v("Trade-Offs")]),_v(" for each?")]),_v(" "),_c('p',[_v("We'll introduce some components to complete the design and to address scalability issues.  Internal load balancers are not shown to reduce clutter.")]),_v(" "),_c('p',[_c('em',[_v("To avoid repeating discussions")]),_v(", refer to the following "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#index-of-system-design-topics"}},[_v("system design topics")]),_v(" for main talking points, tradeoffs, and alternatives:")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#domain-name-system"}},[_v("DNS")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#load-balancer"}},[_v("Load balancer")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#horizontal-scaling"}},[_v("Horizontal scaling")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#reverse-proxy-web-server"}},[_v("Web server (reverse proxy)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-layer"}},[_v("API server (application layer)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache"}},[_v("Cache")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#nosql"}},[_v("NoSQL")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#consistency-patterns"}},[_v("Consistency patterns")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#availability-patterns"}},[_v("Availability patterns")])])]),_v(" "),_c('p',[_v("Some searches are very popular, while others are only executed once.  Popular queries can be served from a "),_c('strong',[_v("Memory Cache")]),_v(" such as Redis or Memcached to reduce response times and to avoid overloading the "),_c('strong',[_v("Reverse Index Service")]),_v(" and "),_c('strong',[_v("Document Service")]),_v(".  The "),_c('strong',[_v("Memory Cache")]),_v(" is also useful for handling the unevenly distributed traffic and traffic spikes.  Reading 1 MB sequentially from memory takes about 250 microseconds, while reading from SSD takes 4x and from disk takes 80x longer."),_c('sup',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("1")])])]),_v(" "),_c('p',[_v("Below are a few other optimizations to the "),_c('strong',[_v("Crawling Service")]),_v(":")]),_v(" "),_c('ul',[_c('li',[_v("To handle the data size and request load, the "),_c('strong',[_v("Reverse Index Service")]),_v(" and "),_c('strong',[_v("Document Service")]),_v(" will likely need to make heavy use sharding and federation.")]),_v(" "),_c('li',[_v("DNS lookup can be a bottleneck, the "),_c('strong',[_v("Crawler Service")]),_v(" can keep its own DNS lookup that is refreshed periodically")]),_v(" "),_c('li',[_v("The "),_c('strong',[_v("Crawler Service")]),_v(" can improve performance and reduce memory usage by keeping many open connections at a time, referred to as "),_c('a',{attrs:{"href":"https://en.wikipedia.org/wiki/Connection_pool"}},[_v("connection pooling")]),_v(" "),_c('ul',[_c('li',[_v("Switching to "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#user-datagram-protocol-udp"}},[_v("UDP")]),_v(" could also boost performance")])])]),_v(" "),_c('li',[_v("Web crawling is bandwidth intensive, ensure there is enough bandwidth to sustain high throughput")])]),_v(" "),_c('h2',{attrs:{"id":"additional-talking-points"}},[_c('span',{staticClass:"anchor",attrs:{"id":"additional-talking-points"}}),_v("Additional talking points"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#additional-talking-points","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("Additional topics to dive into, depending on the problem scope and time remaining.")])]),_v(" "),_c('h3',{attrs:{"id":"sql-scaling-patterns"}},[_c('span',{staticClass:"anchor",attrs:{"id":"sql-scaling-patterns"}}),_v("SQL scaling patterns"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#sql-scaling-patterns","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#master-slave-replication"}},[_v("Read replicas")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#federation"}},[_v("Federation")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sharding"}},[_v("Sharding")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#denormalization"}},[_v("Denormalization")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-tuning"}},[_v("SQL Tuning")])])]),_v(" "),_c('h4',{attrs:{"id":"nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nosql"}}),_v("NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#key-value-store"}},[_v("Key-value store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#document-store"}},[_v("Document store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#wide-column-store"}},[_v("Wide column store")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#graph-database"}},[_v("Graph database")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#sql-or-nosql"}},[_v("SQL vs NoSQL")])])]),_v(" "),_c('h3',{attrs:{"id":"caching"}},[_c('span',{staticClass:"anchor",attrs:{"id":"caching"}}),_v("Caching"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#caching","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Where to cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#client-caching"}},[_v("Client caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cdn-caching"}},[_v("CDN caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#web-server-caching"}},[_v("Web server caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#database-caching"}},[_v("Database caching")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#application-caching"}},[_v("Application caching")])])])]),_v(" "),_c('li',[_v("What to cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-database-query-level"}},[_v("Caching at the database query level")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#caching-at-the-object-level"}},[_v("Caching at the object level")])])])]),_v(" "),_c('li',[_v("When to update the cache\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#cache-aside"}},[_v("Cache-aside")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-through"}},[_v("Write-through")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#write-behind-write-back"}},[_v("Write-behind (write-back)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#refresh-ahead"}},[_v("Refresh ahead")])])])])]),_v(" "),_c('h3',{attrs:{"id":"asynchronism-and-microservices"}},[_c('span',{staticClass:"anchor",attrs:{"id":"asynchronism-and-microservices"}}),_v("Asynchronism and microservices"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#asynchronism-and-microservices","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#message-queues"}},[_v("Message queues")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#task-queues"}},[_v("Task queues")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#back-pressure"}},[_v("Back pressure")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#microservices"}},[_v("Microservices")])])]),_v(" "),_c('h3',{attrs:{"id":"communications"}},[_c('span',{staticClass:"anchor",attrs:{"id":"communications"}}),_v("Communications"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#communications","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Discuss tradeoffs:\n"),_c('ul',[_c('li',[_v("External communication with clients - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest"}},[_v("HTTP APIs following REST")])]),_v(" "),_c('li',[_v("Internal communications - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#remote-procedure-call-rpc"}},[_v("RPC")])])])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#service-discovery"}},[_v("Service discovery")])])]),_v(" "),_c('h3',{attrs:{"id":"security"}},[_c('span',{staticClass:"anchor",attrs:{"id":"security"}}),_v("Security"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#security","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("Refer to the "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#security"}},[_v("security section")]),_v(".")]),_v(" "),_c('h3',{attrs:{"id":"latency-numbers"}},[_c('span',{staticClass:"anchor",attrs:{"id":"latency-numbers"}}),_v("Latency numbers"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#latency-numbers","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("See "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer#latency-numbers-every-programmer-should-know"}},[_v("Latency numbers every programmer should know")]),_v(".")]),_v(" "),_c('h3',{attrs:{"id":"ongoing"}},[_c('span',{staticClass:"anchor",attrs:{"id":"ongoing"}}),_v("Ongoing"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#ongoing","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("Continue benchmarking and monitoring your system to address bottlenecks as they come up")]),_v(" "),_c('li',[_v("Scaling is an iterative process")])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 3.1.1")]),_v("]")])])])}
}];
  