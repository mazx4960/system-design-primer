
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"fixed":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"brand",fn:function(){return [_c('a',{staticClass:"navbar-brand",attrs:{"href":"https://mazx4960.github.io/system-design-primer//index.html","title":"Home"}},[_v("System Design Primer")])]},proxy:true},{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_v(" "),_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Solutions")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/mint/README.html"}},[_v("mint")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/pastebin/README.html"}},[_v("pastebin")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/query_cache/README.html"}},[_v("query_cache")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/sales_rank/README.html"}},[_v("sales_rank")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/scaling_aws/README.html"}},[_v("scaling_aws")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/social_graph/README.html"}},[_v("social_graph")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/twitter/README.html"}},[_v("twitter")])]),_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"https://mazx4960.github.io/system-design-primer//solutions/system_design/web_crawler/README.html"}},[_v("web_crawler")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"font-weight-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Topics")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Preface\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Motivation.html"}},[_v("Motivation")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Ankiflashcards.html"}},[_v("Anki flashcards")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Indexof-system-design-topics.html"}},[_v("Index")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Studyguide.html"}},[_v("Study Guide")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Interview Questions\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Howto-approach-a-system-design-interview-question.html"}},[_v("How to approach a system design interview question")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Object-orienteddesign-interview-questions-with-solutions.html"}},[_v("OOP interview questions")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-interview-questions-with-solutions.html"}},[_v("System design interview questions")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Systemdesign-topics-start-here.html"}},[_v("System design topics")]),_v(" "),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Performancevs-scalability.html"}},[_v("Performance vs scalability")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Latencyvs-throughput.html"}},[_v("Latency vs throughput")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilityvs-consistency.html"}},[_v("Availability vs consistency")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Consistencypatterns.html"}},[_v("Consistency patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Availabilitypatterns.html"}},[_v("Availability patterns")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Domainname-system.html"}},[_v("Domain name system")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contentdelivery-network.html"}},[_v("Content delivery network")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Loadbalancer.html"}},[_v("Load balancer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Reverseproxy-(web-server).html"}},[_v("Reverse proxy (web server)")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Applicationlayer.html"}},[_v("Application layer")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Database.html"}},[_v("Database")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Cache.html"}},[_v("Cache")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Asynchronism.html"}},[_v("Asynchronism")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Communication.html"}},[_v("Communication")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Security.html"}},[_v("Security")])])])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Misc\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Appendix.html"}},[_v("Appendix")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Underdevelopment.html"}},[_v("Under development")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Credits.html"}},[_v("Credits")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contactinfo.html"}},[_v("Contact info")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/Contributing.html"}},[_v("Contributing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"https://mazx4960.github.io/system-design-primer//contents/License.html"}},[_v("License")])])])])])])],1)],1)]),_v(" "),_m(0),_v(" "),_c('overlay-source',{staticClass:"fixed-header-padding",attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"})])],1),_v(" "),_m(1)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('div',{staticClass:"fixed-header-padding",attrs:{"id":"content-wrapper"}},[_c('h1',{attrs:{"id":"pastebin-com-bit-ly"}},[_c('span',{staticClass:"anchor",attrs:{"id":"pastebin-com-bit-ly"}}),_v("设计 "),_c('a',{attrs:{"href":"http://Pastebin.com"}},[_v("Pastebin.com")]),_v(" (或者 "),_c('a',{attrs:{"href":"http://Bit.ly"}},[_v("Bit.ly")]),_v(")"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#pastebin-com-bit-ly","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("注意: 为了避免重复，当前文档会直接链接到"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95"}},[_v("系统设计主题")]),_v("的相关区域，请参考链接内容以获得综合的讨论点、权衡和替代方案。")])]),_v(" "),_c('p',[_c('strong',[_v("设计 "),_c('a',{attrs:{"href":"http://Bit.ly"}},[_v("Bit.ly")])]),_v(" - 是一个类似的问题，区别是 pastebin 需要存储的是 paste 的内容，而不是原始的未短化的 url。")]),_v(" "),_c('h2',{attrs:{"id":""}},[_v("第一步：概述用例和约束")]),_v(" "),_c('blockquote',[_c('p',[_v("收集这个问题的需求和范畴。\n问相关问题来明确用例和约束。\n讨论一些假设。")])]),_v(" "),_c('p',[_v("因为没有面试官来明确这些问题，所以我们自己将定义一些用例和约束。")]),_v(" "),_c('h3',{attrs:{"id":"-2"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-2"}}),_v("用例"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-2","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-3"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-3"}}),_v("我们将问题的范畴限定在如下用例"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-3","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("用户")]),_v(" 输入一段文本，然后得到一个随机生成的链接\n"),_c('ul',[_c('li',[_v("过期设置\n"),_c('ul',[_c('li',[_v("默认的设置是不会过期的")]),_v(" "),_c('li',[_v("可以选择设置一个过期的时间")])])])])]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v(" 输入一个 paste 的 url 后，可以看到它存储的内容")]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v(" 是匿名的")]),_v(" "),_c('li',[_c('strong',[_v("Service")]),_v(" 跟踪页面分析\n"),_c('ul',[_c('li',[_v("一个月的访问统计")])])]),_v(" "),_c('li',[_c('strong',[_v("Service")]),_v(" 删除过期的 pastes")]),_v(" "),_c('li',[_c('strong',[_v("Service")]),_v(" 需要高可用")])]),_v(" "),_c('h4',{attrs:{"id":"-4"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-4"}}),_v("超出范畴的用例"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-4","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("用户")]),_v(" 可以注册一个账户\n"),_c('ul',[_c('li',[_c('strong',[_v("用户")]),_v(" 通过验证邮箱")])])]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v(" 可以用注册的账户登录\n"),_c('ul',[_c('li',[_c('strong',[_v("用户")]),_v(" 可以编辑文档")])])]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v(" 可以设置可见性")]),_v(" "),_c('li',[_c('strong',[_v("用户")]),_v(" 可以设置短链接")])]),_v(" "),_c('h3',{attrs:{"id":"-5"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-5"}}),_v("约束和假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-5","onclick":"event.stopPropagation()"}})]),_v(" "),_c('h4',{attrs:{"id":"-6"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-6"}}),_v("状态假设"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-6","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("访问流量不是均匀分布的")]),_v(" "),_c('li',[_v("打开一个短链接应该是很快的")]),_v(" "),_c('li',[_v("pastes 只能是文本")]),_v(" "),_c('li',[_v("页面访问分析数据可以不用实时")]),_v(" "),_c('li',[_v("一千万的用户量")]),_v(" "),_c('li',[_v("每个月一千万的 paste 写入量")]),_v(" "),_c('li',[_v("每个月一亿的 paste 读取量")]),_v(" "),_c('li',[_v("读写比例在 10:1")])]),_v(" "),_c('h4',{attrs:{"id":"-7"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-7"}}),_v("计算使用"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-7","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_c('strong',[_v("向面试官说明你是否应该粗略计算一下使用情况。")])]),_v(" "),_c('ul',[_c('li',[_v("每个 paste 的大小\n"),_c('ul',[_c('li',[_v("每一个 paste 1 KB")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("shortlink")]),_v(" - 7 bytes")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("expiration_length_in_minutes")]),_v(" - 4 bytes")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("created_at")]),_v(" - 5 bytes")]),_v(" "),_c('li',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("paste_path")]),_v(" - 255 bytes")]),_v(" "),_c('li',[_v("总共 = ~1.27 KB")])])]),_v(" "),_c('li',[_v("每个月新的 paste 内容在 12.7GB\n"),_c('ul',[_c('li',[_v("(1.27 * 10000000)KB / 月的 paste")]),_v(" "),_c('li',[_v("三年内将近 450GB 的新 paste 内容")]),_v(" "),_c('li',[_v("三年内 3.6 亿短链接")]),_v(" "),_c('li',[_v("假设大部分都是新的 paste，而不是需要更新已存在的 paste")])])]),_v(" "),_c('li',[_v("平均 4paste/s 的写入速度")]),_v(" "),_c('li',[_v("平均 40paste/s 的读取速度")])]),_v(" "),_c('p',[_v("简单的转换指南:")]),_v(" "),_c('ul',[_c('li',[_v("2.5 百万 req/s")]),_v(" "),_c('li',[_v("1 req/s = 2.5 百万 req/m")]),_v(" "),_c('li',[_v("40 req/s = 1 亿 req/m")]),_v(" "),_c('li',[_v("400 req/s = 10 亿 req/m")])]),_v(" "),_c('h2',{attrs:{"id":"-8"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-8"}}),_v("第二步：创建一个高层次设计"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-8","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("概述一个包括所有重要的组件的高层次设计")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/BKsBnmG.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/BKsBnmG.png","alt":""}})])]),_v(" "),_c('h2',{attrs:{"id":"-9"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-9"}}),_v("第三步：设计核心组件"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-9","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("深入每一个核心组件的细节")])]),_v(" "),_c('h3',{attrs:{"id":"-10"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-10"}}),_v("用例：用户输入一段文本，然后得到一个随机生成的链接"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-10","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("我们可以用一个 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Frdbms"}},[_v("关系型数据库")]),_v("作为一个大的哈希表，用来把生成的 url 映射到一个包含 paste 文件的文件服务器和路径上。")]),_v(" "),_c('p',[_v("为了避免托管一个文件服务器，我们可以用一个托管的"),_c('strong',[_v("对象存储")]),_v("，比如 Amazon 的 S3 或者"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%96%87%E6%A1%A3%E7%B1%BB%E5%9E%8B%E5%AD%98%E5%82%A8"}},[_v("NoSQL 文档类型存储")]),_v("。")]),_v(" "),_c('p',[_v("作为一个大的哈希表的关系型数据库的替代方案，我们可以用"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%94%AE-%E5%80%BC%E5%AD%98%E5%82%A8"}},[_v("NoSQL 键值存储")]),_v("。我们需要讨论"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%BF%98%E6%98%AF-nosql"}},[_v("选择 SQL 或 NoSQL 之间的权衡")]),_v("。下面的讨论是使用关系型数据库方法。")]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("客户端")]),_v(" 发送一个创建 paste 的请求到作为一个"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"}},[_v("反向代理")]),_v("启动的 "),_c('strong',[_v("Web 服务器")]),_v("。")]),_v(" "),_c('li',[_c('strong',[_v("Web 服务器")]),_v(" 转发请求给 "),_c('strong',[_v("写接口")]),_v(" 服务器")]),_v(" "),_c('li',[_c('strong',[_v("写接口")]),_v(" 服务器执行如下操作：\n"),_c('ul',[_c('li',[_v("生成一个唯一的 url\n"),_c('ul',[_c('li',[_v("检查这个 url 在 "),_c('strong',[_v("SQL 数据库")]),_v(" 里面是否是唯一的")]),_v(" "),_c('li',[_v("如果这个 url 不是唯一的，生成另外一个 url")]),_v(" "),_c('li',[_v("如果我们支持自定义 url，我们可以使用用户提供的 url（也需要检查是否重复）")])])]),_v(" "),_c('li',[_v("把生成的 url 存储到 "),_c('strong',[_v("SQL 数据库")]),_v(" 的 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("pastes")]),_v(" 表里面")]),_v(" "),_c('li',[_v("存储 paste 的内容数据到 "),_c('strong',[_v("对象存储")]),_v(" 里面")]),_v(" "),_c('li',[_v("返回生成的 url")])])])]),_v(" "),_c('p',[_c('strong',[_v("向面试官阐明你需要写多少代码")])]),_v(" "),_c('p',[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("pastes")]),_v(" 表可以有如下结构：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs sql"}},[_c('span',[_v("shortlink "),_c('span',{pre:true,attrs:{"class":"hljs-type"}},[_v("char")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("7")]),_v(") "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NOT")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NULL")]),_v("\n")]),_c('span',[_v("expiration_length_in_minutes "),_c('span',{pre:true,attrs:{"class":"hljs-type"}},[_v("int")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NOT")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NULL")]),_v("\n")]),_c('span',[_v("created_at datetime "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NOT")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NULL")]),_v("\n")]),_c('span',[_v("paste_path "),_c('span',{pre:true,attrs:{"class":"hljs-type"}},[_v("varchar")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("255")]),_v(") "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NOT")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("NULL")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("PRIMARY")]),_v(" KEY(shortlink)\n")])])]),_c('p',[_v("我们将在 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("shortlink")]),_v(" 字段和 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("created_at")]),_v(" 字段上创建一个"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%BD%BF%E7%94%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E7%B4%A2%E5%BC%95"}},[_v("数据库索引")]),_v("，用来提高查询的速度（避免因为扫描全表导致的长时间查询）并将数据保存在内存中，从内存里面顺序读取 1MB 的数据需要大概 250 微秒，而从 SSD 上读取则需要花费 4 倍的时间，从硬盘上则需要花费 80 倍的时间。"),_c('sup',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#每个程序员都应该知道的延迟数"}},[_v(" 1")])])]),_v(" "),_c('p',[_v("为了生成唯一的 url，我们可以：")]),_v(" "),_c('ul',[_c('li',[_v("使用 "),_c('a',{attrs:{"href":"https://en.wikipedia.org/wiki/MD5"}},[_c('strong',[_v("MD5")])]),_v(" 来哈希用户的 IP 地址 + 时间戳\n"),_c('ul',[_c('li',[_v("MD5 是一个普遍用来生成一个 128-bit 长度的哈希值的一种哈希方法")]),_v(" "),_c('li',[_v("MD5 是一致分布的")]),_v(" "),_c('li',[_v("或者我们也可以用 MD5 哈希一个随机生成的数据")])])]),_v(" "),_c('li',[_v("用 "),_c('a',{attrs:{"href":"https://www.kerstner.at/2012/07/shortening-strings-using-base-62-encoding/"}},[_c('strong',[_v("Base 62")])]),_v(" 编码 MD5 哈希值\n"),_c('ul',[_c('li',[_v("对于 urls，使用 Base 62 编码 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("[a-zA-Z0-9]")]),_v(" 是比较合适的")]),_v(" "),_c('li',[_v("对于每一个原始输入只会有一个 hash 结果，Base 62 是确定的（不涉及随机性）")]),_v(" "),_c('li',[_v("Base 64 是另外一个流行的编码方案，但是对于 urls，会因为额外的 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("+")]),_v(" 和 "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("-")]),_v(" 字符串而产生一些问题")]),_v(" "),_c('li',[_v("以下 "),_c('a',{attrs:{"href":"http://stackoverflow.com/questions/742013/how-to-code-a-url-shortener"}},[_v("Base 62 伪代码")]),_v(" 执行的时间复杂度是 O(k)，k 是数字的数量 = 7：")])])])]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("base_encode")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("num, base="),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("62")])]),_v("):")]),_v("\n")]),_c('span',[_v("    digits = []\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("while")]),_v(" num > "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("0")]),_v("\n")]),_c('span',[_v("      remainder = modulo(num, base)\n")]),_c('span',[_v("      digits.push(remainder)\n")]),_c('span',[_v("      num = divide(num, base)\n")]),_c('span',[_v("    digits = digits.reverse\n")])])]),_c('ul',[_c('li',[_v("取输出的前 7 个字符，结果会有 62^7 个可能的值，应该足以满足在 3 年内处理 3.6 亿个短链接的约束：")])]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_v("url = base_encode(md5(ip_address+timestamp))[:URL_LENGTH]\n")])])]),_c('p',[_v("我们将会用一个公开的 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%A1%A8%E8%BF%B0%E6%80%A7%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BBrest"}},[_c('strong',[_v("REST 风格接口")])]),_v("：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs shell"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-meta"}},[_v("$")]),_c('span',{pre:true,attrs:{"class":"bash"}},[_v(" curl -X POST --data "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'{\"expiration_length_in_minutes\":\"60\", \\\"paste_contents\":\"Hello World!\"}'")]),_v(" https://pastebin.com/api/v1/paste")]),_v("\n")])])]),_c('p',[_v("Response:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs json"}},[_c('span',[_v("{\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("\"shortlink\"")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"foobar\"")]),_v("\n")]),_c('span',[_v("}\n")])])]),_c('p',[_v("用于内部通信，我们可以用 "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AErpc"}},[_v("RPC")]),_v("。")]),_v(" "),_c('h3',{attrs:{"id":"paste-url"}},[_c('span',{staticClass:"anchor",attrs:{"id":"paste-url"}}),_v("用例：用户输入一个 paste 的 url 后可以看到它存储的内容"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#paste-url","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('strong',[_v("客户端")]),_v(" 发送一个获取 paste 请求到 "),_c('strong',[_v("Web Server")])]),_v(" "),_c('li',[_c('strong',[_v("Web Server")]),_v(" 转发请求给 "),_c('strong',[_v("读取接口")]),_v(" 服务器")]),_v(" "),_c('li',[_c('strong',[_v("读取接口")]),_v(" 服务器执行如下操作：\n"),_c('ul',[_c('li',[_v("在 "),_c('strong',[_v("SQL 数据库")]),_v(" 检查这个生成的 url\n"),_c('ul',[_c('li',[_v("如果这个 url 在 "),_c('strong',[_v("SQL 数据库")]),_v(" 里面，则从 "),_c('strong',[_v("对象存储")]),_v(" 获取这个 paste 的内容")]),_v(" "),_c('li',[_v("否则，返回一个错误页面给用户")])])])])])]),_v(" "),_c('p',[_v("REST API：")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs shell"}},[_c('span',[_v("curl https://pastebin.com/api/v1/paste?shortlink=foobar\n")])])]),_c('p',[_v("Response:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs json"}},[_c('span',[_v("{\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("\"paste_contents\"")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"Hello World\"")]),_v(",\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("\"created_at\"")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"YYYY-MM-DD HH:MM:SS\"")]),_v(",\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("\"expiration_length_in_minutes\"")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"60\"")]),_v("\n")]),_c('span',[_v("}\n")])])]),_c('h3',{attrs:{"id":"-11"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-11"}}),_v("用例： 服务跟踪分析页面"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-11","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("因为实时分析不是必须的，所以我们可以简单的 "),_c('strong',[_v("MapReduce")]),_v(" "),_c('strong',[_v("Web Server")]),_v(" 的日志，用来生成点击次数。")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs python"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-class"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("class")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("HitCounts")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("MRJob")]),_v("):")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("extract_url")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, line")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Extract the generated url from the log line.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("extract_year_month")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, line")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Return the year and month portions of the timestamp.\"\"\"")]),_v("\n")]),_c('span',[_v("        ...\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("mapper")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, _, line")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Parse each log line, extract and transform relevant lines.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        Emit key value pairs of the form:")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (2016-01, url0), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (2016-01, url0), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (2016-01, url1), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        url = self.extract_url(line)\n")]),_c('span',[_v("        period = self.extract_year_month(line)\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" (period, url), "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("def")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("reducer")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("self, key, values")]),_v("):")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("\"\"\"Sum values for each key.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}}),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (2016-01, url0), 2")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        (2016-01, url1), 1")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        \"\"\"")]),_v("\n")]),_c('span',[_v("        "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("yield")]),_v(" key, "),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("sum")]),_v("(values)\n")])])]),_c('h3',{attrs:{"id":"pastes"}},[_c('span',{staticClass:"anchor",attrs:{"id":"pastes"}}),_v("用例： 服务删除过期的 pastes"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#pastes","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("为了删除过期的 pastes，我们可以直接搜索 "),_c('strong',[_v("SQL 数据库")]),_v(" 中所有的过期时间比当前时间更早的记录，\n所有过期的记录将从这张表里面删除（或者将其标记为过期）。")]),_v(" "),_c('h2',{attrs:{"id":"-12"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-12"}}),_v("第四步：扩展这个设计"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-12","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("给定约束条件，识别和解决瓶颈。")])]),_v(" "),_c('p',[_c('a',{attrs:{"href":"http://i.imgur.com/4edXG0T.png","target":"_self"}},[_c('img',{staticClass:"img-fluid",attrs:{"src":"http://i.imgur.com/4edXG0T.png","alt":""}})])]),_v(" "),_c('p',[_c('strong',[_v("重要提示: 不要简单的从最初的设计直接跳到最终的设计")])]),_v(" "),_c('p',[_v("说明您将迭代地执行这样的操作：1)"),_c('strong',[_v("Benchmark/Load 测试")]),_v("，2)"),_c('strong',[_v("Profile")]),_v(" 出瓶颈，3)在评估替代方案和权衡时解决瓶颈，4)重复前面，可以参考"),_c('a',{attrs:{"href":"/mazx4960.github.io/system-design-primer/solutions/system_design/scaling_aws/README.html"}},[_v("在 AWS 上设计一个可以支持百万用户的系统")]),_v("这个用来解决如何迭代地扩展初始设计的例子。")]),_v(" "),_c('p',[_v("重要的是讨论在初始设计中可能遇到的瓶颈，以及如何解决每个瓶颈。比如，在多个 "),_c('strong',[_v("Web 服务器")]),_v(" 上添加 "),_c('strong',[_v("负载平衡器")]),_v(" 可以解决哪些问题？ "),_c('strong',[_v("CDN")]),_v(" 解决哪些问题？"),_c('strong',[_v("Master-Slave Replicas")]),_v(" 解决哪些问题? 替代方案是什么和怎么对每一个替代方案进行权衡比较？")]),_v(" "),_c('p',[_v("我们将介绍一些组件来完成设计，并解决可伸缩性问题。内部的负载平衡器并不能减少杂乱。")]),_v(" "),_c('p',[_c('strong',[_v("为了避免重复的讨论")]),_v("， 参考以下"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95"}},[_v("系统设计主题")]),_v("获取主要讨论要点、权衡和替代方案：")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F"}},[_v("DNS")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E7%BD%91%E7%BB%9Ccdn"}},[_v("CDN")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8"}},[_v("负载均衡器")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B0%B4%E5%B9%B3%E6%89%A9%E5%B1%95"}},[_v("水平扩展")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"}},[_v("反向代理（web 服务器）")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E5%B1%82"}},[_v("应用层")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98"}},[_v("缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Frdbms"}},[_v("关系型数据库管理系统 (RDBMS)")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%85%E9%9A%9C%E5%88%87%E6%8D%A2"}},[_v("SQL write master-slave failover")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"}},[_v("主从复制")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%80%E8%87%B4%E6%80%A7%E6%A8%A1%E5%BC%8F"}},[_v("一致性模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%AF%E7%94%A8%E6%80%A7%E6%A8%A1%E5%BC%8F"}},[_v("可用性模式")])])]),_v(" "),_c('p',[_c('strong',[_v("分析存储数据库")]),_v(" 可以用比如 Amazon Redshift 或者 Google BigQuery 这样的数据仓库解决方案。")]),_v(" "),_c('p',[_v("一个像 Amazon S3 这样的 "),_c('strong',[_v("对象存储")]),_v("，可以轻松处理每月 12.7 GB 的新内容约束。")]),_v(" "),_c('p',[_v("要处理 "),_c('em',[_v("平均")]),_v(" 每秒 40 读请求(峰值更高)，其中热点内容的流量应该由 "),_c('strong',[_v("内存缓存")]),_v(" 处理，而不是数据库。"),_c('strong',[_v("内存缓存")]),_v(" 对于处理分布不均匀的流量和流量峰值也很有用。只要副本没有陷入复制写的泥潭，"),_c('strong',[_v("SQL Read Replicas")]),_v(" 应该能够处理缓存丢失。")]),_v(" "),_c('p',[_v("对于单个 "),_c('strong',[_v("SQL Write Master-Slave")]),_v("，"),_c('em',[_v("平均")]),_v(" 每秒 4paste 写入 (峰值更高) 应该是可以做到的。否则，我们需要使用额外的 SQL 扩展模式:")]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%81%94%E5%90%88"}},[_v("联合")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%86%E7%89%87"}},[_v("分片")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%9D%9E%E8%A7%84%E8%8C%83%E5%8C%96"}},[_v("非规范化")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#SQL%E8%B0%83%E4%BC%98"}},[_v("SQL 调优")])])]),_v(" "),_c('p',[_v("我们还应该考虑将一些数据移动到 "),_c('strong',[_v("NoSQL 数据库")]),_v("。")]),_v(" "),_c('h2',{attrs:{"id":"-13"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-13"}}),_v("额外的话题"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-13","onclick":"event.stopPropagation()"}})]),_v(" "),_c('blockquote',[_c('p',[_v("是否更深入探讨额外主题，取决于问题的范围和面试剩余的时间。")])]),_v(" "),_c('h3',{attrs:{"id":"nosql"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nosql"}}),_v("NoSQL"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nosql","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%94%AE-%E5%80%BC%E5%AD%98%E5%82%A8"}},[_v("键值存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%96%87%E6%A1%A3%E7%B1%BB%E5%9E%8B%E5%AD%98%E5%82%A8"}},[_v("文档存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%97%E5%9E%8B%E5%AD%98%E5%82%A8"}},[_v("列型存储")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93"}},[_v("图数据库")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#sql-%E8%BF%98%E6%98%AF-nosql"}},[_v("sql 还是 nosql")])])]),_v(" "),_c('h3',{attrs:{"id":"-14"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-14"}}),_v("缓存"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-14","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("在哪缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%93%E5%AD%98"}},[_v("客户端缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#cdn-%E7%BC%93%E5%AD%98"}},[_v("CDN 缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#web-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98"}},[_v("Web 服务器缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%93%E5%AD%98"}},[_v("数据库缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98"}},[_v("应用缓存")])])])]),_v(" "),_c('li',[_v("缓存什么\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98"}},[_v("数据库查询级别的缓存")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AF%B9%E8%B1%A1%E7%BA%A7%E5%88%AB%E7%9A%84%E7%BC%93%E5%AD%98"}},[_v("对象级别的缓存")])])])]),_v(" "),_c('li',[_v("何时更新缓存\n"),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98%E6%A8%A1%E5%BC%8F"}},[_v("缓存模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%9B%B4%E5%86%99%E6%A8%A1%E5%BC%8F"}},[_v("直写模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%9E%E5%86%99%E6%A8%A1%E5%BC%8F"}},[_v("回写模式")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%88%B7%E6%96%B0"}},[_v("刷新")])])])])]),_v(" "),_c('h3',{attrs:{"id":"-15"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-15"}}),_v("异步和微服务"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-15","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"}},[_v("消息队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97"}},[_v("任务队列")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%83%8C%E5%8E%8B"}},[_v("背压")])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%BE%AE%E6%9C%8D%E5%8A%A1"}},[_v("微服务")])])]),_v(" "),_c('h3',{attrs:{"id":"-16"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-16"}}),_v("通信"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-16","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("讨论权衡:\n"),_c('ul',[_c('li',[_v("跟客户端之间的外部通信 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%A1%A8%E8%BF%B0%E6%80%A7%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BBrest"}},[_v("HTTP APIs following REST")])]),_v(" "),_c('li',[_v("内部通信 - "),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AErpc"}},[_v("RPC")])])])]),_v(" "),_c('li',[_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0"}},[_v("服务发现")])])]),_v(" "),_c('h3',{attrs:{"id":"-17"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-17"}}),_v("安全"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-17","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("参考"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%AE%89%E5%85%A8"}},[_v("安全")]),_v("。")]),_v(" "),_c('h3',{attrs:{"id":"-18"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-18"}}),_v("延迟数字"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-18","onclick":"event.stopPropagation()"}})]),_v(" "),_c('p',[_v("见"),_c('a',{attrs:{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%AF%8F%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%91%98%E9%83%BD%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%95%B0"}},[_v("每个程序员都应该知道的延迟数")]),_v("。")]),_v(" "),_c('h3',{attrs:{"id":"-19"}},[_c('span',{staticClass:"anchor",attrs:{"id":"-19"}}),_v("持续进行"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#-19","onclick":"event.stopPropagation()"}})]),_v(" "),_c('ul',[_c('li',[_v("继续对系统进行基准测试和监控，以在瓶颈出现时解决它们")]),_v(" "),_c('li',[_v("扩展是一个迭代的过程")])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 3.1.1")]),_v("]")])])])}
}];
  